"use strict";(self.webpackChunkfrontend_gad=self.webpackChunkfrontend_gad||[]).push([[1394],{1394:(at,L,r)=>{r.r(L),r.d(L,{IncidentRejeteModule:()=>ot});var P=r(6814),U=r(3975),j=r(3096),H=r(5779),z=r(4970),D=r(2572),g=r(7398),n=r(676);const u="Incident Rejete Superviseur",N=(0,n.PH)(`[${u} API] Load All`),Y=(0,n.PH)(`[${u} API] Load All Success`,(0,n.Ky)()),b=(0,n.PH)(`[${u} API] Create`,(0,n.Ky)()),K=(0,n.PH)(`[${u} API] Create Success`,(0,n.Ky)()),G=(0,n.PH)(`[${u} API] Load`,(0,n.Ky)()),O=(0,n.PH)(`[${u} API] Reset`),Q=(0,n.PH)(`[${u} API] Load Success`,(0,n.Ky)()),W=(0,n.PH)(`[${u} API] Delete`,(0,n.Ky)()),J=(0,n.PH)(`[${u} API] Delete Success`,(0,n.Ky)()),V=(0,n.PH)(`[${u} API] Update`,(0,n.Ky)()),X=(0,n.PH)(`[${u} API] Update Success`,(0,n.Ky)()),k=(0,n.PH)(`[${u} API] Load Form Model`),q=(0,n.PH)(`[${u} API] Reset Form Model`),w=(0,n.PH)(`[${u} API] Load Form Model Success`,(0,n.Ky)()),ee=(0,n.PH)(`[${u} API] Reset Search`),te=(0,n.PH)(`[${u} API] Search`,(0,n.Ky)()),ne=(0,n.PH)(`[${u} API] Change Page`,(0,n.Ky)()),se=(0,n.PH)(`[${u} API] Change Page Size`,(0,n.Ky)()),o={loadItems:N,loadItemsSuccess:Y,resetItem:O,createItem:b,createItemSuccess:K,loadItem:G,loadItemSuccess:Q,updateItem:V,updateItemSuccess:X,deleteItem:W,deleteItemSuccess:J,loadFormModel:k,resetFormModel:q,loadFormModelSuccess:w,setError:(0,n.PH)(`[${u} API] Create Error`,(0,n.Ky)()),resetError:(0,n.PH)(`[${u} API] Reset Error`),resetErrorField:(0,n.PH)(`[${u} API] Reset Error Field`,(0,n.Ky)()),resetSearch:ee,search:te,changePage:ne,changePageSize:se},ae=(0,n.Lq)({formModel:null,searchModel:{},items:[],currentItem:null,page:1,pageSize:15,totalElement:0,errors:null},(0,n.on)(o.loadItemsSuccess,(t,i)=>({...t,items:i.items,totalElement:i.totalElement})),(0,n.on)(o.resetItem,(t,i)=>({...t,currentItem:null})),(0,n.on)(o.createItemSuccess,(t,i)=>({...t})),(0,n.on)(o.deleteItemSuccess,(t,i)=>({...t})),(0,n.on)(o.loadItemSuccess,(t,i)=>({...t,currentItem:i.item})),(0,n.on)(o.updateItemSuccess,(t,i)=>({...t})),(0,n.on)(o.loadFormModel,(t,i)=>({...t,formModel:null})),(0,n.on)(o.loadFormModelSuccess,(t,i)=>({...t,formModel:i.formModel})),(0,n.on)(o.resetSearch,(t,i)=>({...t,searchModel:{}})),(0,n.on)(o.search,(t,i)=>({...t,searchModel:i.searchModel})),(0,n.on)(o.changePage,(t,i)=>({...t,page:i.page})),(0,n.on)(o.changePageSize,(t,i)=>({...t,pageSize:i.pageSize})),(0,n.on)(o.setError,(t,i)=>({...t,errors:i.errors})),(0,n.on)(o.resetError,(t,i)=>({...t,errors:{}})),(0,n.on)(o.resetErrorField,(t,i)=>{let s={};return null!==t.errors&&Object.entries(t.errors).forEach(([c,d])=>{c!==i.fieldName&&(s[`${c}`]=d)}),{...t,errors:s}})),v=(0,n.ZF)("incident-rejetes"),le=(0,n.P1)(v,t=>t.items),de=((0,n.P1)(v,t=>t.currentItem),(0,n.P1)(v,t=>t.formModel),(0,n.P1)(v,t=>t.searchModel)),R=(0,n.P1)(v,t=>t.page),M=(0,n.P1)(v,t=>t.pageSize),pe=(0,n.P1)(v,t=>t.totalElement);(0,n.P1)(v,t=>t.errors);var _=r(9784),e=r(9468),T=r(8281),F=r(3849),x=r(95),ue=r(7251),me=r(166),he=r(6327),fe=r(8564),ge=r(8223),ve=r(602),Ie=r(1469),_e=r(6326),Se=r(8346),Ce=r(1171),Pe=r(547),xe=r(362);function Ze(t,i){1&t&&(e.TgZ(0,"th",30),e._uU(1,"R\xe9f\xe9rence"),e.qZA())}function Te(t,i){if(1&t&&(e.TgZ(0,"td",31),e._uU(1),e.qZA()),2&t){const s=i.$implicit;e.xp6(1),e.Oqu(s.refSys)}}function $e(t,i){1&t&&(e.TgZ(0,"th",30),e._uU(1,"Cat\xe9gorie"),e.qZA())}function Ae(t,i){if(1&t&&(e.TgZ(0,"td",31),e._uU(1),e.qZA()),2&t){const s=i.$implicit;e.xp6(1),e.Oqu(null==s.categorieIncident?null:s.categorieIncident.code)}}function Ee(t,i){1&t&&(e.TgZ(0,"th",32),e._uU(1,"Libell\xe9 Demande"),e.qZA())}function ye(t,i){if(1&t&&(e.TgZ(0,"td",33),e._uU(1),e.qZA()),2&t){const s=i.$implicit;e.xp6(1),e.Oqu(s.titre)}}function Le(t,i){1&t&&(e.TgZ(0,"th",30),e._uU(1,"Equipement"),e.qZA())}function je(t,i){if(1&t&&(e.TgZ(0,"td",33),e._uU(1),e.qZA()),2&t){const s=i.$implicit;e.xp6(1),e.Oqu(s.equipement.libelle)}}function Re(t,i){1&t&&(e.TgZ(0,"th",30),e._uU(1,"Statut"),e.qZA())}function Me(t,i){if(1&t&&(e.TgZ(0,"td",33),e._uU(1),e.qZA()),2&t){const s=i.$implicit;e.xp6(1),e.Oqu(s.statutIncident)}}function Fe(t,i){1&t&&(e.TgZ(0,"th",30),e._uU(1,"Demandeur"),e.qZA())}function Be(t,i){if(1&t&&(e.TgZ(0,"td",33),e._uU(1),e.qZA()),2&t){const s=i.$implicit;e.xp6(1),e.AsE(" ",null==s.demandeur?null:s.demandeur.firstName," ",null==s.demandeur?null:s.demandeur.lastName," ")}}function Ue(t,i){1&t&&(e.TgZ(0,"th",30),e._uU(1,"Date \xe9mission"),e.qZA())}function He(t,i){if(1&t&&(e.TgZ(0,"td",33),e._uU(1),e.ALo(2,"date"),e.qZA()),2&t){const s=i.$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,s.dateOuverture,"dd/MM/y \xe0 HH:mm:ss"))}}function ze(t,i){1&t&&(e.TgZ(0,"th",30),e._uU(1,"Date Derni\xe8re Modif"),e.qZA())}function De(t,i){if(1&t&&(e.TgZ(0,"td",33),e._uU(1),e.ALo(2,"date"),e.qZA()),2&t){const s=i.$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,s.dateDerniereModification,"dd/MM/y \xe0 HH:mm:ss"))}}function Ne(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"table",17),e.NdJ("itemSelected",function(d){e.CHM(s);const f=e.oxw(2);return e.KtG(f.itemSelected(d))}),e.ynx(1,18),e.YNc(2,Ze,2,0,"th",19),e.YNc(3,Te,2,1,"td",20),e.BQk(),e.ynx(4,21),e.YNc(5,$e,2,0,"th",19),e.YNc(6,Ae,2,1,"td",20),e.BQk(),e.ynx(7,22),e.YNc(8,Ee,2,0,"th",23),e.YNc(9,ye,2,1,"td",24),e.BQk(),e.ynx(10,25),e.YNc(11,Le,2,0,"th",19),e.YNc(12,je,2,1,"td",24),e.BQk(),e.ynx(13,26),e.YNc(14,Re,2,0,"th",19),e.YNc(15,Me,2,1,"td",24),e.BQk(),e.ynx(16,27),e.YNc(17,Fe,2,0,"th",19),e.YNc(18,Be,2,2,"td",24),e.BQk(),e.ynx(19,28),e.YNc(20,Ue,2,0,"th",19),e.YNc(21,He,3,4,"td",24),e.BQk(),e.ynx(22,29),e.YNc(23,ze,2,0,"th",19),e.YNc(24,De,3,4,"td",24),e.BQk(),e.qZA()}if(2&t){const s=i.ngIf,c=e.oxw(2);e.Q6J("items",s)("headers",c.headerTable)("selectable",!0)}}function Ye(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"app-crud-list",3),e.NdJ("searchButtonClicked",function(){e.CHM(s);const d=e.oxw();return e.KtG(d.searchButtonClicked())})("refreshButtonClicked",function(){e.CHM(s);const d=e.oxw();return e.KtG(d.refreshButtonClicked())})("pageSelected",function(d){e.CHM(s);const f=e.oxw();return e.KtG(f.pageSelected(d))})("pageSizeChange",function(d){e.CHM(s);const f=e.oxw();return e.KtG(f.pageSizeChange(d))})("closeButtonClicked",function(){e.CHM(s);const d=e.oxw();return e.KtG(d.closeButtonClicked())}),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6),e._UZ(4,"app-form-label",7),e.qZA(),e.TgZ(5,"div",8),e._UZ(6,"app-custom-textfield",9),e.qZA()()(),e._UZ(7,"div",10)(8,"div",11),e.TgZ(9,"div",12),e._UZ(10,"app-custom-button",13),e.TgZ(11,"app-print-button",14),e.NdJ("printButtonClicked",function(){e.CHM(s);const d=e.oxw();return e.KtG(d.printButtonClicked())}),e.qZA()(),e.TgZ(12,"div",15),e.YNc(13,Ne,25,3,"table",16),e.ALo(14,"async"),e.qZA()()}if(2&t){const s=i.ngIf,c=e.oxw();e.Q6J("itemSelected",c.isItemSelected())("pageSize",s.pageSize)("currentPage",s.page)("totalElements",s.totalElement),e.xp6(1),e.Q6J("formGroup",c.searchForm),e.xp6(6),e.Q6J("formGroup",c.searchForm),e.xp6(6),e.Q6J("ngIf",e.lcZ(14,7,c.items$))}}let be=(()=>{class t{constructor(s,c,d){this.router=s,this.store=c,this.incidentFormService=d,this.isUpdateActivated=!1,this.headerTable=["R\xe9f\xe9rence","Cat & sous-categorie","Libell\xe9 Demande","Equipement","Statut","Priorit\xe9","S\xe9v\xe9rit\xe9","Impact","Demandeur","service/unit.Fonct","Date Cr\xe9ation","Date Dern modif"],this.items$=this.store.select(le),this.page$=this.store.select(R),this.pageSize$=this.store.select(M),this.totalElement$=this.store.select(pe),this.data$=(0,D.a)([this.page$,this.pageSize$,this.totalElement$]).pipe((0,g.U)(([f,A,E])=>({page:f,pageSize:A,totalElement:E}))),this.selectedItem=null}ngOnInit(){this.searchForm=this.incidentFormService.createSearchForm(),this.store.dispatch(_.NY.loadItems())}closeIncidentButtonClicked(){const s=this.selectedItem?.id;s&&(this.store.dispatch(_.NY.resetItem()),this.router.navigate(["incidents","cloturer-incident","affect",s]))}itemSelected(s){this.selectedItem=s}pageSelected(s){this.store.dispatch(_.NY.changePage({page:s}))}pageSizeChange(s){this.store.dispatch(_.NY.changePageSize({pageSize:s}))}closeButtonClicked(){this.router.navigate(["incidents"])}isItemSelected(){return null!==this.selectedItem}refreshButtonClicked(){this.searchForm.reset(),this.store.dispatch(_.NY.resetSearch())}searchButtonClicked(){this.store.dispatch(_.NY.search({searchModel:this.searchForm.value}))}printButtonClicked(){}static#e=this.\u0275fac=function(c){return new(c||t)(e.Y36(T.F0),e.Y36(n.yh),e.Y36(j.X))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-incident-rejete-list"]],features:[e._Bn([j.X,U.x,z.W,H.P])],decls:4,vars:3,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Supervision Incident","pathLevelTwo","Incident Rejet\xe9","pathLevelThree","Liste"],["title","Liste des Incidents Rej\xe9t\xe9s",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked",4,"ngIf"],["title","Liste des Incidents Rej\xe9t\xe9s",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked"],[1,"normal-search",3,"formGroup"],[1,"d-flex","flex-row","align-items-center"],[1,"text-end","me-1","width-label-search"],["title","Libell\xe9"],[1,"input-textfield-container","col-3"],["placeholder","","otherclass","item-input","formControlName","titre"],[1,"advance-search",3,"formGroup"],[1,"primary-actions"],[1,"secondary-actions","d-flex"],["customClass","btn btn-sm button-action","title","Exporter","url","export.svg",1,"me-1","ms-1"],[3,"printButtonClicked"],[1,"table-content"],["appDynamicTable","",3,"items","headers","selectable","itemSelected",4,"ngIf"],["appDynamicTable","",3,"items","headers","selectable","itemSelected"],["appCellDef","R\xe9f\xe9rence"],["app-header-attribute-def-template","",4,"appHeaderDefTemplate"],["app-cell-def-template","","class","text-start",4,"appCellDefTemplate"],["appCellDef","Cat & sous-categorie"],["appCellDef","Libell\xe9 Demande"],["app-header-attribute-def-template","","class","width-30",4,"appHeaderDefTemplate"],["app-cell-def-template","","class","left",4,"appCellDefTemplate"],["appCellDef","Equipement"],["appCellDef","Statut"],["appCellDef","Demandeur"],["appCellDef","Date Emission"],["appCellDef","Date Modification"],["app-header-attribute-def-template",""],["app-cell-def-template","",1,"text-start"],["app-header-attribute-def-template","",1,"width-30"],["app-cell-def-template","",1,"left"]],template:function(c,d){1&c&&(e.TgZ(0,"div",0),e._UZ(1,"app-custom-breadcrumb",1),e.qZA(),e.YNc(2,Ye,15,9,"app-crud-list",2),e.ALo(3,"async")),2&c&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,d.data$)))},dependencies:[P.O5,F.L,x.JJ,x.JL,x.sg,x.u,ue._,me.x,he.N,fe.D,ge.h,ve.u,Ie.O,_e.q,Se.W,Ce.h,Pe.Z,xe.V,P.Ov,P.uU],styles:["[_nghost-%COMP%]{width:100%}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}.left[_ngcontent-%COMP%]{text-align:left!important}"]})}return t})();var Ke=r(8510),Ge=r(3396),Oe=r(1793),a=r(6465),Qe=r(9207),We=r(2030),Je=r(2460),I=r(6328),Ve=r(9026),S=r(6306),$=r(9397),Xe=r(1631),m=r(6063),ke=r(9862),h=r(2096),qe=r(3186),we=r(4664),et=r(9989),tt=r(1946);let B=(()=>{class t extends et.v{getResourceBasePath(){return`${tt.y}/supervision-incident-rejete`}getIdValue(s){return s.id}static#e=this.\u0275fac=function(){let s;return function(d){return(s||(s=e.n5z(t)))(d||t)}}();static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac})}return t})();var nt=r(6366),st=r(797);let it=(()=>{class t{constructor(s,c,d,f,A,E){this.incidentRejeteService=s,this.authService=c,this.actions$=d,this.router=f,this.modalService=A,this.store=E,this.loadItems$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.loadItems),(0,Je.M)(this.store.select(R),this.store.select(M),this.store.select(de)),(0,I.b)(([l,p,Z,y])=>(console.log(p),this.store.dispatch((0,m.Q)()),(0,Ve.$)(this.incidentRejeteService.getAllWithPagination(p,Z,y),this.incidentRejeteService.count(y)).pipe((0,g.U)(([C,ct])=>(this.store.dispatch((0,m.Z)()),o.loadItemsSuccess({items:C,totalElement:ct}))),(0,S.K)(C=>(this.store.dispatch((0,m.Z)()),(0,h.of)(o.setError({errors:C})))))))),{dispatch:!0}),this.createItem$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.createItem),(0,I.b)(l=>(this.store.dispatch((0,m.Q)()),console.log(l.item),this.incidentRejeteService.add(l.item).pipe((0,$.b)(()=>{this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident ajout\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/incident-rejete")}),(0,g.U)(p=>o.createItemSuccess({item:p})),(0,S.K)(p=>(this.store.dispatch((0,m.Z)()),(0,h.of)(o.setError({errors:p})))))))),{dispatch:!0}),this.loadItem$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.loadItem),(0,Xe.z)(l=>this.incidentRejeteService.findById(l.id).pipe((0,g.U)(p=>o.loadItemSuccess({item:p})),(0,S.K)(p=>(this.store.dispatch((0,m.Z)()),(0,h.of)(o.setError({errors:p}))))))),{dispatch:!0}),this.deleteItem$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.deleteItem),(0,I.b)(l=>this.incidentRejeteService.delete(l.item.id,l.item)),(0,$.b)(()=>{this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident supprim\xe9 avec succ\xe8s"})}),(0,g.U)(()=>o.loadItems()),(0,S.K)(l=>(this.store.dispatch((0,m.Z)()),(0,h.of)(o.setError({errors:l}))))),{dispatch:!0}),this.updateItem$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.updateItem),(0,I.b)(l=>(this.store.dispatch((0,m.Q)()),this.incidentRejeteService.update(l.item.id,l.item).pipe((0,$.b)(()=>{this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident modifi\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/incident-rejete")}),(0,g.U)(p=>o.createItemSuccess({item:p})),(0,S.K)(p=>(this.store.dispatch((0,m.Z)()),(0,h.of)(o.setError({errors:p})))))))),{dispatch:!0}),this.loadFormModel$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.loadFormModel),(0,I.b)(()=>this.incidentRejeteService.getFormModel()),(0,g.U)(l=>o.loadFormModelSuccess({formModel:l})),(0,S.K)(l=>(0,h.of)(o.setError({errors:l}))))),this.resetSearch$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.resetSearch),(0,I.b)(()=>(0,h.of)(o.changePage({page:1}))))),this.search$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.search),(0,I.b)(()=>(0,h.of)(o.changePage({page:1}))))),this.changePage$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.changePage),(0,g.U)(l=>o.loadItems()))),this.changePageSize$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.changePageSize),(0,I.b)(()=>(0,h.of)(o.changePage({page:1}))))),this.handleError$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(o.setError),(0,we.w)(l=>{if(this.store.dispatch((0,m.Q)()),l.errors instanceof ke.UA){if(422===l.errors.status){let p="",Z=0;for(const[y,C]of Object.entries(l.errors.error))p+=0===Z?C:"\n"+C,Z++;this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:p})}if(403===l.errors.status&&this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:"Vous n'avez pas le droit requis pour effectuer cette action"}),401===l.errors.status){let p="Votre token a expir\xe9, veuillez vous reconnecter svp!";return this.authService.removeToken(),this.authService.removeUserInfo(),this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:p}),(0,h.of)(qe.jM())}}return this.store.dispatch((0,m.Z)()),(0,h.of)({type:"noop"})})),{dispatch:!0})}static#e=this.\u0275fac=function(c){return new(c||t)(e.LFG(B),e.LFG(nt.e),e.LFG(a.eX),e.LFG(T.F0),e.LFG(st.Z),e.LFG(n.yh))};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac})}return t})();const rt=[{path:"",component:be,pathMatch:"prefix"}];let ot=(()=>{class t{static#e=this.\u0275fac=function(c){return new(c||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({providers:[B],imports:[P.ez,F.L,n.Aw.forFeature("incident-rejetes",ae),a.sQ.forFeature(it),Ke.Y,We.h,Ge.B,Oe.K,Qe.m,T.Bz.forChild(rt)]})}return t})()}}]);