"use strict";(self.webpackChunkfrontend_gad=self.webpackChunkfrontend_gad||[]).push([[1515],{1515:(L,x,r)=>{r.r(x),r.d(x,{BatimentModule:()=>Ie});var m=r(6814),t=r(9468),Z=r(1227),c=r(95);let p=(()=>{class o{constructor(){}createForm(e){return new c.cw({code:new c.NI(e.code,{nonNullable:!0,validators:[c.kI.required]}),nombreNiveau:new c.NI(e.nombreNiveau,{nonNullable:!0,validators:[c.kI.required]}),pays:new c.NI(e.pays),departement:new c.NI(e.departement),ville:new c.NI(e.ville),entreprise:new c.NI(e.entreprise),filiale:new c.NI(e.filiale),nomSite:new c.NI(e.nomSite),site:new c.NI(e.site,{nonNullable:!0,validators:[c.kI.required]}),utilisateurModification:new c.NI(e.utilisateurModification),utilisateurCreation:new c.NI(e.utilisateurCreation),dateCreation:new c.NI(e.dateCreation),dateDerniereModification:new c.NI(e.dateDerniereModification)})}createSearchForm(){return new c.cw({code:new c.NI("",{nonNullable:!0,validators:[c.kI.required]}),nombreNiveau:new c.NI(0,{nonNullable:!0,validators:[c.kI.required]})})}static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac})}return o})();var C=r(2572),g=r(7398),n=r(676);const d="Batiment",I=(0,n.PH)(`[${d} API] Load All`),T=(0,n.PH)(`[${d} API] Load All Success`,(0,n.Ky)()),E=(0,n.PH)(`[${d} API] Create`,(0,n.Ky)()),F=(0,n.PH)(`[${d} API] Create Success`,(0,n.Ky)()),W=(0,n.PH)(`[${d} API] Load`,(0,n.Ky)()),j=(0,n.PH)(`[${d} API] Load Success`,(0,n.Ky)()),V=(0,n.PH)(`[${d} API] Create Error`,(0,n.Ky)()),q=(0,n.PH)(`[${d} API] Reset Error`),X=(0,n.PH)(`[${d} API] Reset Error Field`,(0,n.Ky)()),tt=(0,n.PH)(`[${d} API] Reset`),et=(0,n.PH)(`[${d} API] Delete`,(0,n.Ky)()),ot=(0,n.PH)(`[${d} API] Delete Success`,(0,n.Ky)()),a={loadItems:I,loadItemsSuccess:T,resetItem:tt,createItem:E,createItemSuccess:F,loadItem:W,loadItemSuccess:j,updateItem:(0,n.PH)(`[${d} API] Update`,(0,n.Ky)()),updateItemSuccess:(0,n.PH)(`[${d} API] Update Success`,(0,n.Ky)()),deleteItem:et,deleteItemSuccess:ot,setError:V,resetError:q,resetErrorField:X,loadFormModel:(0,n.PH)(`[${d} API] Load Form Model`),resetFormModel:(0,n.PH)(`[${d} API] Reset Form Model`),loadFormModelSuccess:(0,n.PH)(`[${d} API] Load Form Model Success`,(0,n.Ky)()),resetSearch:(0,n.PH)(`[${d} API] Reset Search`),search:(0,n.PH)(`[${d} API] Search`,(0,n.Ky)()),changePage:(0,n.PH)(`[${d} API] Change Page`,(0,n.Ky)()),changePageSize:(0,n.PH)(`[${d} API] Change Page Size`,(0,n.Ky)())},ut=(0,n.Lq)({formModel:null,searchModel:{},items:[],currentItem:null,page:1,pageSize:15,totalElement:0,errors:null},(0,n.on)(a.loadItemsSuccess,(o,s)=>(console.log(s.items),{...o,items:s.items,totalElement:s.totalElement})),(0,n.on)(a.resetItem,(o,s)=>({...o,currentItem:null})),(0,n.on)(a.createItemSuccess,(o,s)=>({...o})),(0,n.on)(a.deleteItemSuccess,(o,s)=>({...o})),(0,n.on)(a.loadItemSuccess,(o,s)=>({...o,currentItem:s.item})),(0,n.on)(a.updateItemSuccess,(o,s)=>({...o})),(0,n.on)(a.loadFormModel,(o,s)=>({...o,formModel:null})),(0,n.on)(a.loadFormModelSuccess,(o,s)=>({...o,formModel:s.formModel})),(0,n.on)(a.resetSearch,(o,s)=>({...o,searchModel:{}})),(0,n.on)(a.search,(o,s)=>({...o,searchModel:s.searchModel})),(0,n.on)(a.changePage,(o,s)=>({...o,page:s.page})),(0,n.on)(a.changePageSize,(o,s)=>({...o,pageSize:s.pageSize})),(0,n.on)(a.setError,(o,s)=>({...o,errors:s.errors})),(0,n.on)(a.resetError,(o,s)=>({...o,errors:null})),(0,n.on)(a.resetErrorField,(o,s)=>{let e={};return null!==o.errors&&Object.entries(o.errors).forEach(([i,l])=>{i!==s.fieldName&&(e[`${i}`]=l)}),{...o,errors:e}})),y=(0,n.ZF)("batiments"),ft=(0,n.P1)(y,o=>o.items),ht=(0,n.P1)(y,o=>o.currentItem),O=(0,n.P1)(y,o=>o.formModel),_t=(0,n.P1)(y,o=>o.searchModel),H=(0,n.P1)(y,o=>o.page),z=(0,n.P1)(y,o=>o.pageSize),gt=(0,n.P1)(y,o=>o.totalElement),Ct=(0,n.P1)(y,o=>o.errors);var vt=r(4849),A=r(8281),D=r(797),Q=r(3849),bt=r(7251),Zt=r(166),xt=r(6327),Tt=r(8564),yt=r(8223),Bt=r(602),It=r(1469),St=r(6326),G=r(8346),Y=r(1171),k=r(547),U=r(362);function Mt(o,s){1&o&&(t.TgZ(0,"th",35),t._uU(1,"R\xe9f\xe9rence"),t.qZA())}function Pt(o,s){if(1&o&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e.refSys)}}function At(o,s){1&o&&(t.TgZ(0,"th",35),t._uU(1,"Code"),t.qZA())}function Et(o,s){if(1&o&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e.code)}}function Nt(o,s){1&o&&(t.TgZ(0,"th",35),t._uU(1,"Nbre Niveau"),t.qZA())}function Lt(o,s){if(1&o&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e.nombreNiveau)}}function Ft(o,s){1&o&&(t.TgZ(0,"th",35),t._uU(1,"Site"),t.qZA())}function Ot(o,s){if(1&o&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e.site.nomLong)}}function Dt(o,s){1&o&&(t.TgZ(0,"th",35),t._uU(1,"Filiale"),t.qZA())}function Ut(o,s){if(1&o&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(e.site.filiale.nomLong)}}function $t(o,s){1&o&&(t.TgZ(0,"th",35),t._uU(1,"Date cr\xe9ation"),t.qZA())}function Jt(o,s){if(1&o&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.dateCreation,"dd/MM/y \xe0 HH:mm:ss"))}}function Kt(o,s){1&o&&(t.TgZ(0,"th",35),t._uU(1,"Date Derni\xe8re Modif"),t.qZA())}function Ht(o,s){if(1&o&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.dateDerniereModification,"dd/MM/y \xe0 HH:mm:ss"))}}function zt(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"table",24),t.NdJ("itemSelected",function(l){t.CHM(e);const _=t.oxw(2);return t.KtG(_.itemSelected(l))}),t.ynx(1,25),t.YNc(2,Mt,2,0,"th",26),t.YNc(3,Pt,2,1,"td",27),t.BQk(),t.ynx(4,28),t.YNc(5,At,2,0,"th",26),t.YNc(6,Et,2,1,"td",27),t.BQk(),t.ynx(7,29),t.YNc(8,Nt,2,0,"th",26),t.YNc(9,Lt,2,1,"td",27),t.BQk(),t.ynx(10,30),t.YNc(11,Ft,2,0,"th",26),t.YNc(12,Ot,2,1,"td",27),t.BQk(),t.ynx(13,31),t.YNc(14,Dt,2,0,"th",26),t.YNc(15,Ut,2,1,"td",27),t.BQk(),t.ynx(16,32),t.YNc(17,$t,2,0,"th",26),t.YNc(18,Jt,3,4,"td",33),t.BQk(),t.ynx(19,34),t.YNc(20,Kt,2,0,"th",26),t.YNc(21,Ht,3,4,"td",33),t.BQk(),t.qZA()}if(2&o){const e=s.ngIf,i=t.oxw(2);t.Q6J("items",e)("headers",i.headerTable)("selectable",!0)}}function Qt(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"app-crud-list",3),t.NdJ("searchButtonClicked",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.searchButtonClicked())})("refreshButtonClicked",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.refreshButtonClicked())})("pageSelected",function(l){t.CHM(e);const _=t.oxw();return t.KtG(_.pageSelected(l))})("pageSizeChange",function(l){t.CHM(e);const _=t.oxw();return t.KtG(_.pageSizeChange(l))})("closeButtonClicked",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.closeButtonClicked())}),t.TgZ(1,"div",4)(2,"div",5)(3,"div",6),t._UZ(4,"app-form-label",7),t.qZA(),t.TgZ(5,"div",8),t._UZ(6,"app-custom-textfield",9),t.qZA()()(),t.TgZ(7,"div",10)(8,"div",11)(9,"div",6),t._UZ(10,"app-form-label",12),t.qZA(),t.TgZ(11,"div",8),t._UZ(12,"app-custom-textfield",13),t.qZA()()(),t.TgZ(13,"div",14)(14,"app-custom-button",15),t.NdJ("buttonClicked",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.addButtonClicked())}),t.qZA(),t.TgZ(15,"app-custom-button",16),t.NdJ("buttonClicked",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.editButtonClicked())}),t.qZA(),t.TgZ(16,"app-custom-button",17),t.NdJ("buttonClicked",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.deleteButtonClicked())}),t.qZA()(),t.TgZ(17,"div",18),t._UZ(18,"app-custom-button",19)(19,"app-custom-button",20),t.TgZ(20,"app-print-button",21),t.NdJ("printButtonClicked",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.printButtonClicked())}),t.qZA()(),t.TgZ(21,"div",22),t.YNc(22,zt,22,3,"table",23),t.ALo(23,"async"),t.qZA()()}if(2&o){const e=s.ngIf,i=t.oxw();t.Q6J("itemSelected",i.isItemSelected())("pageSize",e.pageSize)("currentPage",e.page)("totalElements",e.totalElement),t.xp6(1),t.Q6J("formGroup",i.searchForm),t.xp6(6),t.Q6J("formGroup",i.searchForm),t.xp6(8),t.Q6J("disabled",!i.isItemSelected()),t.xp6(1),t.Q6J("disabled",!i.isItemSelected()),t.xp6(6),t.Q6J("ngIf",t.lcZ(23,9,i.items$))}}(0,m.qS)(Z.Z,"fr-Fr");let Gt=(()=>{class o{constructor(e,i,l,_){this.router=e,this.modalService=i,this.store=l,this.batimentFormService=_,this.headerTable=["R\xe9f\xe9rence","Code","Nbre Niveau","Site","Filiale","Date Cr\xe9ation","Date Derni\xe8re Modif"],this.items$=this.store.select(ft),this.page$=this.store.select(H),this.pageSize$=this.store.select(z),this.totalElement$=this.store.select(gt),this.data$=(0,C.a)([this.page$,this.pageSize$,this.totalElement$]).pipe((0,g.U)(([S,J,u])=>({page:S,pageSize:J,totalElement:u}))),this.selectedItem=null}ngOnInit(){this.searchForm=this.batimentFormService.createSearchForm(),this.store.dispatch(a.loadItems())}addButtonClicked(){this.router.navigate(["administration","batiments","add"])}editButtonClicked(){const e=this.selectedItem?.id;e&&(this.store.dispatch(a.resetItem()),this.router.navigate(["administration","batiments","edit",e]))}deleteButtonClicked(){const e=this.selectedItem;e&&this.modalService.openComponent(vt.n,{size:"md",otherclass:"custom-modal-height"}).afterClosed.subscribe(i=>{i&&"yes"===i&&this.store.dispatch(a.deleteItem({item:e}))})}itemSelected(e){this.selectedItem=e}pageSelected(e){this.store.dispatch(a.changePage({page:e}))}pageSizeChange(e){this.store.dispatch(a.changePageSize({pageSize:e}))}closeButtonClicked(){this.router.navigate(["administration"])}isItemSelected(){return null!==this.selectedItem}refreshButtonClicked(){this.searchForm.reset(),this.store.dispatch(a.resetSearch())}searchButtonClicked(){this.store.dispatch(a.search({searchModel:this.searchForm.value}))}printButtonClicked(){}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(A.F0),t.Y36(D.Z),t.Y36(n.yh),t.Y36(p))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-batiment-list"]],features:[t._Bn([p,{provide:t.soG,useValue:"fr-FR"}])],decls:4,vars:3,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Domiciliations","pathLevelTwo","B\xe2timents","pathLevelThree","Liste"],["title","Liste des B\xe2timents",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked",4,"ngIf"],["title","Liste des B\xe2timents",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked"],[1,"normal-search",3,"formGroup"],[1,"d-flex","flex-row","align-items-center"],[1,"text-end","me-1","width-label-search-1"],["title","Code B\xe2timent"],[1,"input-textfield-container","col-3"],["placeholder","","otherclass","item-input","formControlName","code"],[1,"advance-search",3,"formGroup"],[1,"d-flex","flex-row","mt-2","align-items-center"],["title","Nombre Niveau"],["placeholder","","otherclass","item-input","formControlName","nombreNiveau"],[1,"primary-actions"],["icon","icon-plus btn-icon-add fw-bold","title","Ajouter",1,"me-1",3,"buttonClicked"],["icon","icon-edit-alt btn-icon-edit","title","Modifier",1,"me-1",3,"disabled","buttonClicked"],["icon","icon-trash btn-icon-delete","title","Supprimer",3,"disabled","buttonClicked"],[1,"secondary-actions","d-flex"],["customClass","btn btn-sm button-action","title","Importer","url","import.svg"],["customClass","btn btn-sm button-action","title","Exporter","url","export.svg",1,"me-1","ms-1"],[3,"printButtonClicked"],[1,"table-content"],["appDynamicTable","",3,"items","headers","selectable","itemSelected",4,"ngIf"],["appDynamicTable","",3,"items","headers","selectable","itemSelected"],["appCellDef","R\xe9f\xe9rence"],["app-header-attribute-def-template","",4,"appHeaderDefTemplate"],["app-cell-def-template","","class","text-start",4,"appCellDefTemplate"],["appCellDef","Code"],["appCellDef","Nbre Niveau"],["appCellDef","Site"],["appCellDef","Filiale"],["appCellDef","Date Cr\xe9ation"],["app-cell-def-template","",4,"appCellDefTemplate"],["appCellDef","Date Derni\xe8re Modif"],["app-header-attribute-def-template",""],["app-cell-def-template","",1,"text-start"],["app-cell-def-template",""]],template:function(i,l){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"app-custom-breadcrumb",1),t.qZA(),t.YNc(2,Qt,24,11,"app-crud-list",2),t.ALo(3,"async")),2&i&&(t.xp6(2),t.Q6J("ngIf",t.lcZ(3,1,l.data$)))},dependencies:[m.O5,Q.L,c.JJ,c.JL,c.sg,c.u,bt._,Zt.x,xt.N,Tt.D,yt.h,Bt.u,It.O,St.q,G.W,Y.h,k.Z,U.V,m.Ov,m.uU],styles:["[_nghost-%COMP%]{width:100%}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}"]})}return o})();var Yt=r(8819),kt=r(9543),wt=r(7426),Rt=r(9887),Wt=r(5973),jt=r(4944),Vt=r(2093),qt=r(6136),Xt=r(8513),te=r(586),ee=r(1327),oe=r(5188);function ie(o,s){1&o&&(t.TgZ(0,"th",47),t._uU(1,"Nom Court"),t.qZA())}function ne(o,s){if(1&o&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.hij(" ",e.nomCourt," ")}}function re(o,s){1&o&&(t.TgZ(0,"th",47),t._uU(1,"Nom Long"),t.qZA())}function se(o,s){if(1&o&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.xp6(1),t.hij(" ",e.nomLong," ")}}function ae(o,s){1&o&&(t.TgZ(0,"table",42),t.ynx(1,43),t.YNc(2,ie,2,0,"th",44),t.YNc(3,ne,2,1,"td",45),t.BQk(),t.ynx(4,46),t.YNc(5,re,2,0,"th",44),t.YNc(6,se,2,1,"td",45),t.BQk(),t.qZA())}function le(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"app-field-error-wrapper",39),t.NdJ("resetField",function(l){t.CHM(e);const _=t.oxw(2);return t.KtG(_.resetBackendError(l))}),t.TgZ(1,"app-item-search",40),t.YNc(2,ae,7,0,"table",41),t.qZA()()}if(2&o){const e=s.ngIf,i=t.oxw(2);t.Q6J("errors",i.errors),t.xp6(1),t.Q6J("headers",i.siteSelectItemsHeader)("items",e.sites)("criterias",i.siteItemCritterias)("itemDescription",i.siteItemDescription)}}function ce(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"form",2)(1,"div",3)(2,"app-panel-custom",4)(3,"div",5)(4,"div",6),t._UZ(5,"app-form-label",7),t.TgZ(6,"div",8),t._UZ(7,"app-custom-textfield",9),t.qZA()(),t.TgZ(8,"div",6),t._UZ(9,"app-form-label",10),t.TgZ(10,"div",8),t._UZ(11,"app-custom-textfield",11),t.qZA()()(),t.TgZ(12,"div",5)(13,"div",6),t._UZ(14,"app-form-label",12),t.TgZ(15,"div",8),t._UZ(16,"app-custom-textfield",13),t.qZA()(),t.TgZ(17,"div",6),t._UZ(18,"app-form-label",14),t.TgZ(19,"div",8),t._UZ(20,"app-custom-textfield",15),t.qZA()()()(),t.TgZ(21,"app-panel-custom",16)(22,"div",5)(23,"div",6),t._UZ(24,"app-form-label",17),t.TgZ(25,"div",8),t._UZ(26,"app-custom-textfield",18),t.qZA()(),t.TgZ(27,"div",6),t._UZ(28,"app-form-label",19),t.TgZ(29,"div",8),t._UZ(30,"app-custom-textfield",20),t.qZA()(),t.TgZ(31,"div",6),t._UZ(32,"app-form-label",21),t.TgZ(33,"div",8),t._UZ(34,"app-custom-textfield",22),t.qZA()()(),t.TgZ(35,"div",5)(36,"div",6),t._UZ(37,"app-form-label",23),t.TgZ(38,"div",8),t._UZ(39,"app-custom-textfield",24),t.qZA()(),t.TgZ(40,"div",6),t._UZ(41,"app-form-label",25),t.TgZ(42,"div",8),t._UZ(43,"app-custom-textfield",26),t.qZA()(),t.TgZ(44,"div",6),t._UZ(45,"app-form-label",27),t.TgZ(46,"div",8),t._UZ(47,"app-custom-textfield",28),t.qZA(),t.YNc(48,le,3,5,"app-field-error-wrapper",29),t.ALo(49,"async"),t.qZA()()(),t.TgZ(50,"app-panel-custom",30)(51,"div",5)(52,"div",6),t._UZ(53,"app-form-label",31),t.TgZ(54,"div",8)(55,"app-field-error-wrapper",32),t.NdJ("resetField",function(l){t.CHM(e);const _=t.oxw();return t.KtG(_.resetBackendError(l))}),t._UZ(56,"app-custom-textfield",33),t.qZA()()(),t.TgZ(57,"div",6),t._UZ(58,"app-form-label",34),t.TgZ(59,"div",8),t._UZ(60,"app-custom-textfield",35),t.qZA()()()(),t.TgZ(61,"div",36)(62,"app-primary-button",37),t.NdJ("buttonClicked",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.submitForm())}),t.qZA(),t.TgZ(63,"app-cancel-button",38),t.NdJ("buttonClicked",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.returnToList())}),t.qZA()()()()}if(2&o){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(7),t.Q6J("readonly",!0),t.xp6(4),t.Q6J("readonly",!0),t.xp6(5),t.Q6J("readonly",!0),t.xp6(4),t.Q6J("readonly",!0),t.xp6(6),t.Q6J("readonly",!0),t.xp6(4),t.Q6J("readonly",!0),t.xp6(4),t.Q6J("readonly",!0),t.xp6(5),t.Q6J("readonly",!0),t.xp6(4),t.Q6J("readonly",!0),t.xp6(4),t.Q6J("readonly",!0),t.xp6(1),t.Q6J("ngIf",t.lcZ(49,13,e.formModel$)),t.xp6(7),t.Q6J("errors",e.errors)}}let w=(()=>{class o{constructor(e,i,l,_){this.formService=e,this.modalService=i,this.router=l,this.store=_,this.formModel$=this.store.select(O),this.errors=null,this.formSubmitted=new t.vpe,this.siteSelectItemsHeader=["Nom Court","Nom Long"],this.siteItemDescription=S=>S.nomCourt,this.siteItemCritterias={nomCourt:"Nom Court",nomLong:"Nom Long"}}ngOnInit(){this.store.dispatch(a.loadFormModel()),this.store.select(Ct).subscribe(e=>{this.errors=e}),this.store.dispatch(a.resetError()),this.form=this.formService.createForm(this.batiment),this.formModel$.subscribe(e=>{console.log(e)}),this.form.get("site")?.valueChanges.subscribe(e=>{e&&(this.form.get("pays")?.setValue(e.ville.departement.pays.libelle),this.form.get("departement")?.setValue(e.ville.departement.nomLong),this.form.get("ville")?.setValue(e.ville.nomLong),this.form.get("entreprise")?.setValue(e.filiale.entreprise.nomLong),this.form.get("filiale")?.setValue(e.filiale.nomLong),this.form.get("nomSite")?.setValue(e.nomLong))})}ngOnDestroy(){}submitForm(){this.formSubmitted.emit(this.form.getRawValue())}returnToList(){this.router.navigateByUrl("administration/batiments")}resetBackendError(e){this.store.dispatch(a.resetErrorField({fieldName:e}))}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(p),t.Y36(D.Z),t.Y36(A.F0),t.Y36(n.yh))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-batiment-form"]],inputs:{batiment:"batiment"},outputs:{formSubmitted:"formSubmitted"},features:[t._Bn([p])],decls:2,vars:1,consts:[["id","main",1,"ps-3","pe-3","pt-0"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"form-main","p-2"],["icon","fa fa-angle-right","title","Historique"],[1,"general-info"],[1,"input-container","col-4"],["title","Date Cr\xe9ation",1,"col-5","text-end"],[1,"input-textfield-container","col"],["otherclass","custom-style-form","placeholder","","formControlName","dateCreation",3,"readonly"],["title","Cr\xe9\xe9 Par",1,"col-5","text-end"],["otherclass","custom-style-form","placeholder","","formControlName","utilisateurCreation",3,"readonly"],["title","Date Derni\xe8re Modif",1,"col-5","text-end"],["otherclass","custom-style-form","formControlName","dateDerniereModification","placeholder","",3,"readonly"],["title","Modifi\xe9 Par",1,"col-5","text-end"],["otherclass","custom-style-form","placeholder","","formControlName","utilisateurModification",3,"readonly"],["icon","fa fa-angle-right","title","Informations sur le Site"],["title","Pays",1,"col-3","text-end"],["otherclass","custom-style-form","placeholder","","formControlName","pays",3,"readonly"],["title","D\xe9partement",1,"w-form","text-end"],["otherclass","custom-style-form","placeholder","","formControlName","departement",3,"readonly"],["title","Ville",1,"col-2","text-end"],["otherclass","custom-style-form","placeholder","","formControlName","ville",3,"readonly"],["title","Entreprise",1,"col-3","text-end"],["otherclass","custom-style-form","placeholder","","formControlName","entreprise",3,"readonly"],["title","Filiale",1,"w-form","text-end"],["otherclass","custom-style-form","placeholder","","formControlName","filiale",3,"readonly"],["title","Site",1,"col-2","text-end"],["otherclass","custom-style-form","placeholder","","formControlName","nomSite",3,"readonly"],["class","",3,"errors","resetField",4,"ngIf"],["icon","fa fa-angle-right","title","Informations g\xe9n\xe9rales"],["title","Code",1,"col-3","text-end"],[3,"errors","resetField"],["otherclass","custom-style-form","placeholder","","formControlName","code"],["title","Nombre Niveau",1,"col-5","text-end"],["otherclass","custom-style-form","placeholder","","formControlName","nombreNiveau"],[1,"form-actions"],["title","Enregistrer",1,"me-1",3,"buttonClicked"],["title","Annuler","otherclass","custom-cancel-button",3,"buttonClicked"],[1,"",3,"errors","resetField"],["otherclass","custom-style-item-selection-form","formControlName","site",1,"ml-2",3,"headers","items","criterias","itemDescription"],["app-item-search-template-attribute","",4,"appItemSearchTemplate"],["app-item-search-template-attribute",""],["appItemSearchCellDef","Nom Court"],["app-item-search-header-def-template","","class","custom-head",4,"appItemSearchHeaderDefTemplate"],["app-item-search-cell-def-template","","class","custom-head",4,"appItemSearchCellDefTemplate"],["appItemSearchCellDef","Nom Long"],["app-item-search-header-def-template","",1,"custom-head"],["app-item-search-cell-def-template","",1,"custom-head"]],template:function(i,l){1&i&&(t.TgZ(0,"div",0),t.YNc(1,ce,64,15,"form",1),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngIf",l.form))},dependencies:[m.O5,c._Y,c.JJ,c.JL,c.sg,c.u,Yt.F,G.W,Y.h,kt.C,k.Z,wt.p,Rt.l,Wt.v,jt.K,Vt.d,qt.D,Xt.T,te.o,ee.g,oe.K,m.Ov],styles:[".general-info[_ngcontent-%COMP%]{display:flex;padding:5px 0;width:100%}.form-main[_ngcontent-%COMP%]{background-color:#e7e8ea;border:1px solid #c7c5c6}.input-container[_ngcontent-%COMP%]{display:flex}.input-textfield-container[_ngcontent-%COMP%]{margin-left:4px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:.5rem}.form-actions[_ngcontent-%COMP%]   app-primary-button[_ngcontent-%COMP%]{margin-left:.5rem}"]})}return o})(),me=(()=>{class o{constructor(e){this.store=e,this.formModel$=this.store.select(O),this.batiment={id:"",code:"",nombreNiveau:0,nomSite:"",filiale:"",entreprise:"",ville:"",departement:"",pays:"",site:null,dateDerniereModification:null,dateCreation:null,utilisateurCreation:"",utilisateurModification:""}}ngOnInit(){this.store.dispatch(a.resetItem()),this.store.dispatch(a.resetFormModel())}addBatiment(e){this.store.dispatch(a.createItem({item:{code:e.code,nombreNiveau:e.nombreNiveau,site:e.site}}))}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(n.yh))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-batiment-add"]],decls:3,vars:1,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Domiciliations","pathLevelTwo","B\xe2timents","pathLevelThree","Ajouter"],["id","main",3,"batiment","formSubmitted"]],template:function(i,l){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"app-custom-breadcrumb",1),t.qZA(),t.TgZ(2,"app-batiment-form",2),t.NdJ("formSubmitted",function(S){return l.addBatiment(S)}),t.qZA()),2&i&&(t.xp6(2),t.Q6J("batiment",l.batiment))},dependencies:[U.V,w],styles:["[_nghost-%COMP%]{width:100%}"]})}return o})();var pe=r(7394);function de(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"app-batiment-form",3),t.NdJ("formSubmitted",function(l){t.CHM(e);const _=t.oxw();return t.KtG(_.editBatiment(l))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("batiment",e.batimentDto)}}let ue=(()=>{class o{constructor(e,i){this.store=e,this.route=i,this.formModel$=this.store.select(O),this.batiment$=this.store.select(ht),this.batimentDto=null,this.subscription=new pe.w0}ngOnInit(){this.store.dispatch(a.resetFormModel()),this.subscription=this.route.params.subscribe(e=>{this.id=e.id,this.id&&this.store.dispatch(a.loadItem({id:this.id}))}),this.batiment$.subscribe(e=>{null!==e&&(this.batimentDto={id:e.id,code:e.code,nombreNiveau:e.nombreNiveau,filiale:null===e.site?"":e.site.filiale.nomLong,entreprise:null===e.site?"":e.site.filiale.entreprise.nomLong,nomSite:null===e.site?"":e.site.nomLong,departement:null===e.site?"":e.site.ville.departement.nomLong,pays:null===e.site?"":e.site.ville.departement.pays.libelle,ville:null===e.site?"":e.site.ville.nomLong,site:null===e.site?null:e.site,dateDerniereModification:null===e.dateDerniereModification?"":this.formatDate(e.dateDerniereModification),dateCreation:null===e.dateCreation?"":this.formatDate(e.dateCreation),utilisateurCreation:e.utilisateurCreation,utilisateurModification:e.utilisateurModification})})}formatDate(e){if(e){const i=new Date(e);return i.toLocaleDateString()+" \xe0 "+i.toLocaleTimeString()}return null}ngOnDestroy(){this.subscription.unsubscribe()}editBatiment(e){const i={id:e.id,code:e.code,nombreNiveau:e.nombreNiveau,site:e.site};this.store.dispatch(a.updateItem({id:Number(this.id),item:i}))}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(n.yh),t.Y36(A.gz))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-batiment-edit"]],decls:3,vars:1,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Domiciliations","pathLevelTwo","B\xe2timents","pathLevelThree","Editer"],[3,"batiment","formSubmitted",4,"ngIf"],[3,"batiment","formSubmitted"]],template:function(i,l){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"app-custom-breadcrumb",1),t.qZA(),t.YNc(2,de,1,1,"app-batiment-form",2)),2&i&&(t.xp6(2),t.Q6J("ngIf",l.batimentDto))},dependencies:[m.O5,U.V,w],styles:["[_nghost-%COMP%]{width:100%}"]})}return o})();var fe=r(9207),f=r(6465),he=r(2460),B=r(6328),_e=r(9026),v=r(6063),M=r(6306),$=r(9397),ge=r(1631),Ce=r(9862),b=r(2096),ve=r(4664),be=r(3186),Ze=r(9989),xe=r(1946);let R=(()=>{class o extends Ze.v{getResourceBasePath(){return`${xe.y}/batiment`}static#t=this.\u0275fac=function(){let e;return function(l){return(e||(e=t.n5z(o)))(l||o)}}();static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac})}return o})();var Te=r(6366);let ye=(()=>{class o{constructor(e,i,l,_,S,J){this.batimentService=e,this.authService=i,this.actions$=l,this.router=_,this.modalService=S,this.store=J,this.loadItems$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.loadItems),(0,he.M)(this.store.select(H),this.store.select(z),this.store.select(_t)),(0,B.b)(([u,h,N,K])=>(console.log(h),this.store.dispatch((0,v.Q)()),(0,_e.$)(this.batimentService.getAllWithPagination(h,N,K),this.batimentService.count(K)).pipe((0,g.U)(([P,Se])=>(this.store.dispatch((0,v.Z)()),a.loadItemsSuccess({items:P,totalElement:Se}))),(0,M.K)(P=>(this.store.dispatch((0,v.Z)()),(0,b.of)(a.setError({errors:P})))))))),{dispatch:!0}),this.createItem$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.createItem),(0,B.b)(u=>(this.store.dispatch((0,v.Q)()),this.batimentService.add(u.item).pipe((0,$.b)(()=>{this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Batiment ajout\xe9 avec succ\xe8s"}),this.router.navigateByUrl("administration/batiments")}),(0,g.U)(h=>a.createItemSuccess({item:h})),(0,M.K)(h=>(this.store.dispatch((0,v.Z)()),(0,b.of)(a.setError({errors:h})))))))),{dispatch:!0}),this.loadItem$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.loadItem),(0,ge.z)(u=>this.batimentService.findById(u.id).pipe((0,g.U)(h=>a.loadItemSuccess({item:h})),(0,M.K)(h=>(this.store.dispatch((0,v.Z)()),(0,b.of)(a.setError({errors:h}))))))),{dispatch:!0}),this.deleteItem$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.deleteItem),(0,B.b)(u=>this.batimentService.delete(u.item.id,u.item)),(0,$.b)(()=>{this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Batiment supprim\xe9 avec succ\xe8s"})}),(0,g.U)(()=>a.loadItems()),(0,M.K)(u=>(this.store.dispatch((0,v.Z)()),(0,b.of)(a.setError({errors:u}))))),{dispatch:!0}),this.updateItem$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.updateItem),(0,B.b)(u=>(this.store.dispatch((0,v.Q)()),this.batimentService.update(u.id,u.item).pipe((0,$.b)(()=>{this.store.dispatch((0,v.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Batiment modifi\xe9 avec succ\xe8s"}),this.router.navigateByUrl("administration/batiments")}),(0,g.U)(h=>a.createItemSuccess({item:h})),(0,M.K)(h=>(this.store.dispatch((0,v.Z)()),(0,b.of)(a.setError({errors:h})))))))),{dispatch:!0}),this.loadFormModel$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.loadFormModel),(0,B.b)(()=>this.batimentService.getFormModel()),(0,g.U)(u=>a.loadFormModelSuccess({formModel:u})),(0,M.K)(u=>(this.store.dispatch((0,v.Z)()),(0,b.of)(a.setError({errors:u})))))),this.resetSearch$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.resetSearch),(0,B.b)(()=>(0,b.of)(a.changePage({page:1}))))),this.search$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.search),(0,B.b)(()=>(0,b.of)(a.changePage({page:1}))))),this.changePage$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.changePage),(0,g.U)(u=>a.loadItems()))),this.changePageSize$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.changePageSize),(0,B.b)(()=>(0,b.of)(a.changePage({page:1}))))),this.handleError$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(a.setError),(0,ve.w)(u=>{if(this.store.dispatch((0,v.Q)()),u.errors instanceof Ce.UA){if(422===u.errors.status){let h="",N=0;for(const[K,P]of Object.entries(u.errors.error))h+=0===N?P:"\n"+P,N++;this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:h})}if(403===u.errors.status&&this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:"Vous n'avez pas le droit requis pour effectuer cette action"}),401===u.errors.status)return this.authService.removeToken(),this.authService.removeUserInfo(),(0,b.of)(be.jM())}return this.store.dispatch((0,v.Z)()),(0,b.of)({type:"noop"})})),{dispatch:!0})}static#t=this.\u0275fac=function(i){return new(i||o)(t.LFG(R),t.LFG(Te.e),t.LFG(f.eX),t.LFG(A.F0),t.LFG(D.Z),t.LFG(n.yh))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac})}return o})();const Be=[{path:"",component:Gt,pathMatch:"prefix"},{path:"add",component:me,pathMatch:"prefix"},{path:"edit/:id",component:ue,pathMatch:"prefix"}];let Ie=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({providers:[R],imports:[m.ez,Q.L,n.Aw.forFeature("batiments",ut),f.sQ.forFeature(ye),fe.m,A.Bz.forChild(Be)]})}return o})()},8819:(L,x,r)=>{r.d(x,{F:()=>t});var m=r(9468);let t=(()=>{class Z{constructor(){this.disabled=!1,this.buttonClicked=new m.vpe}emitButtonClicked(){this.buttonClicked.emit()}static#t=this.\u0275fac=function(C){return new(C||Z)};static#e=this.\u0275cmp=m.Xpm({type:Z,selectors:[["app-cancel-button"]],inputs:{title:"title",url:"url",otherclass:"otherclass",disabled:"disabled"},outputs:{buttonClicked:"buttonClicked"},decls:2,vars:5,consts:[[3,"disabled","click"]],template:function(C,g){1&C&&(m.TgZ(0,"button",0),m.NdJ("click",function(){return g.emitButtonClicked()}),m._uU(1),m.qZA()),2&C&&(m.Gre("cancel-button ",g.otherclass,""),m.Q6J("disabled",g.disabled),m.xp6(1),m.hij(" ",g.title,"\n"))},styles:[".cancel-button[_ngcontent-%COMP%]{color:#000;border:1px solid #6d7582;background-color:#fff;min-width:120px;display:flex!important;align-items:center!important;justify-content:center!important;font-size:12px;height:25px;padding:.75rem 0rem;border-radius:3px}"]})}return Z})()},4849:(L,x,r)=>{r.d(x,{n:()=>g});var m=r(1892),t=r(6814),Z=r(8666),c=r(2463),p=r(9468),C=r(166);let g=(()=>{class n{constructor(I,T){this.modalData=I,this.modalRef=T}close(){this.modalRef.close(void 0)}confirmAction(){this.modalRef.close("yes")}static#t=this.\u0275fac=function(T){return new(T||n)(p.Y36(m.S),p.Y36(m.R))};static#e=this.\u0275cmp=p.Xpm({type:n,selectors:[["app-confirm-alert"]],standalone:!0,features:[p.jDz],decls:13,vars:0,consts:[[1,"alert-header","mb-3"],[1,"alert-header-title"],[1,"mb-0"],[1,"pe-3","ps-3","pt-0"],[1,"d-flex","align-items-center","p-2"],[1,"me-3"],["src","assets/images/warning.svg","width","45px","alt",""],[1,"text"],[1,"form-actions"],["otherclass","custom-cancel-button color-warning","title","Oui",1,"me-1",3,"buttonClicked"],["otherclass","custom-cancel-button","title","Fermer",3,"buttonClicked"]],template:function(T,E){1&T&&(p.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),p._uU(3,"Confirmation de Suppression"),p.qZA()()(),p.TgZ(4,"div",3)(5,"div",4)(6,"div",5),p._UZ(7,"img",6),p.qZA(),p.TgZ(8,"div",7),p._uU(9," Voulez-vous vraiment effectuer cette action ? "),p.qZA()(),p.TgZ(10,"div",8)(11,"app-custom-button",9),p.NdJ("buttonClicked",function(){return E.confirmAction()}),p.qZA(),p.TgZ(12,"app-custom-button",10),p.NdJ("buttonClicked",function(){return E.close()}),p.qZA()()())},dependencies:[t.ez,Z.a,c.v,C.x],styles:[".general-info[_ngcontent-%COMP%]{display:flex;padding:5px 0;width:100%}.form-main[_ngcontent-%COMP%]{background-color:#e7e8ea;border:1px solid #c7c5c6}.input-container[_ngcontent-%COMP%]{display:flex;align-items:center}.input-textfield-container[_ngcontent-%COMP%]{margin-left:4px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:.5rem}.form-actions[_ngcontent-%COMP%]   app-primary-button[_ngcontent-%COMP%]{margin-left:.5rem}.alert-header[_ngcontent-%COMP%]{background-color:#ed6f25;color:#fff;padding:.5rem 1rem;display:flex;align-items:center}.alert-header-title[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1}.close-icon[_ngcontent-%COMP%]{cursor:pointer}.alert-header-title[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1rem}input[type=file][_ngcontent-%COMP%]{font-size:13px}.circle-content-error[_ngcontent-%COMP%]{border-radius:50%;border:1px solid #ed6f25;color:#ed6f25;width:70px;height:70px;display:flex;align-items:center;justify-content:center}.circle-content-error[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:25px}.text[_ngcontent-%COMP%]{font-size:14px!important}"]})}return n})()},3849:(L,x,r)=>{r.d(x,{L:()=>p});var m=r(9468),t=r(2463),Z=r(6814),c=r(166);let p=(()=>{class C{constructor(){this.printButtonClicked=new m.vpe}emitPrintButtonClicked(){this.printButtonClicked.emit()}static#t=this.\u0275fac=function(d){return new(d||C)};static#e=this.\u0275cmp=m.Xpm({type:C,selectors:[["app-print-button"]],outputs:{printButtonClicked:"printButtonClicked"},standalone:!0,features:[m.jDz],decls:1,vars:0,consts:[["customClass","btn btn-sm button-action","title","Imprimer","url","print.svg",3,"buttonClicked"]],template:function(d,I){1&d&&(m.TgZ(0,"app-custom-button",0),m.NdJ("buttonClicked",function(){return I.emitPrintButtonClicked()}),m.qZA())},dependencies:[Z.ez,t.v,c.x],styles:["[_nghost-%COMP%]{display:block}"]})}return C})()}}]);