"use strict";(self.webpackChunkfrontend_gad=self.webpackChunkfrontend_gad||[]).push([[2312],{2312:(Qe,L,s)=>{s.r(L),s.d(L,{IncidentsRejetesModule:()=>Ge});var S=s(6814),Z=s(8281),B=s(4970),U=s(5779),D=s(3975),R=s(3096),F=s(2572),_=s(7398),c=s(676),u=s(4972);const b=(0,c.Lq)({formModel:null,searchModel:{},items:[],currentItem:null,page:1,pageSize:15,totalElement:0,errors:null},(0,c.on)(u.NY.loadItemsSuccess,(t,n)=>({...t,items:n.items,totalElement:n.totalElement})),(0,c.on)(u.NY.resetItem,(t,n)=>({...t,currentItem:null})),(0,c.on)(u.NY.createItemSuccess,(t,n)=>({...t})),(0,c.on)(u.NY.deleteItemSuccess,(t,n)=>({...t})),(0,c.on)(u.NY.loadItemSuccess,(t,n)=>({...t,currentItem:n.item})),(0,c.on)(u.NY.updateItemSuccess,(t,n)=>({...t})),(0,c.on)(u.NY.loadFormModel,(t,n)=>({...t,formModel:null})),(0,c.on)(u.NY.loadFormModelSuccess,(t,n)=>({...t,formModel:n.formModel})),(0,c.on)(u.NY.resetSearch,(t,n)=>({...t,searchModel:{}})),(0,c.on)(u.NY.search,(t,n)=>({...t,searchModel:n.searchModel})),(0,c.on)(u.NY.changePage,(t,n)=>({...t,page:n.page})),(0,c.on)(u.NY.changePageSize,(t,n)=>({...t,pageSize:n.pageSize})),(0,c.on)(u.NY.setError,(t,n)=>({...t,errors:n.errors})),(0,c.on)(u.NY.resetError,(t,n)=>({...t,errors:{}})),(0,c.on)(u.NY.resetErrorField,(t,n)=>{let i={};return null!==t.errors&&Object.entries(t.errors).forEach(([o,d])=>{o!==n.fieldName&&(i[`${o}`]=d)}),{...t,errors:i}})),g=(0,c.ZF)("incident-rejetes"),z=(0,c.P1)(g,t=>t.items),G=((0,c.P1)(g,t=>t.currentItem),(0,c.P1)(g,t=>t.formModel),(0,c.P1)(g,t=>t.searchModel)),$=(0,c.P1)(g,t=>t.page),M=(0,c.P1)(g,t=>t.pageSize),O=(0,c.P1)(g,t=>t.totalElement);(0,c.P1)(g,t=>t.errors);var r=s(9784),e=s(9468),y=s(3849),N=s(95),Q=s(7251),H=s(166),K=s(6327),W=s(8564),J=s(8223),V=s(602),X=s(1469),k=s(6326),q=s(8346),w=s(1171),ee=s(547),te=s(362);function ie(t,n){1&t&&(e.TgZ(0,"th",32),e._uU(1,"R\xe9f\xe9rence"),e.qZA())}function ne(t,n){if(1&t&&(e.TgZ(0,"td",33),e._uU(1),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.Oqu(i.refSys)}}function se(t,n){1&t&&(e.TgZ(0,"th",34),e._uU(1,"Libell\xe9 Demande"),e.qZA())}function re(t,n){if(1&t&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.Oqu(i.titre)}}function oe(t,n){1&t&&(e.TgZ(0,"th",32),e._uU(1,"Equipement"),e.qZA())}function ce(t,n){if(1&t&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.Oqu(i.equipement.libelle)}}function ae(t,n){1&t&&(e.TgZ(0,"th",32),e._uU(1,"Statut"),e.qZA())}function le(t,n){if(1&t&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.Oqu(i.statutIncident)}}function de(t,n){1&t&&(e.TgZ(0,"th",32),e._uU(1,"Demandeur"),e.qZA())}function pe(t,n){if(1&t&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.AsE("",null==i.demandeur?null:i.demandeur.firstName," ",null==i.demandeur?null:i.demandeur.lastName,"")}}function ue(t,n){1&t&&(e.TgZ(0,"th",32),e._uU(1,"Priorit\xe9"),e.qZA())}function me(t,n){if(1&t&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.Oqu(i.prioriteIncident)}}function he(t,n){1&t&&(e.TgZ(0,"th",32),e._uU(1,"S\xe9v\xe9rit\xe9"),e.qZA())}function fe(t,n){if(1&t&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.Oqu(null==i.severite?null:i.severite.libelle)}}function _e(t,n){1&t&&(e.TgZ(0,"th",32),e._uU(1,"Date Cr\xe9ation"),e.qZA())}function ge(t,n){if(1&t&&(e.TgZ(0,"td",35),e._uU(1),e.ALo(2,"date"),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,i.dateCreation,"dd/MM/y \xe0 HH:mm:ss"))}}function ve(t,n){1&t&&(e.TgZ(0,"th",32),e._uU(1,"Date Rejet"),e.qZA())}function Ce(t,n){if(1&t&&(e.TgZ(0,"td",35),e._uU(1),e.ALo(2,"date"),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,i.dateRejet,"dd/MM/y \xe0 HH:mm:ss"))}}function Ie(t,n){1&t&&(e.TgZ(0,"th",32),e._uU(1,"Date Derni\xe8re Modif"),e.qZA())}function Se(t,n){if(1&t&&(e.TgZ(0,"td",35),e._uU(1),e.ALo(2,"date"),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,i.dateDerniereModification,"dd/MM/y \xe0 HH:mm:ss"))}}function Ne(t,n){if(1&t){const i=e.EpF();e.TgZ(0,"table",17),e.NdJ("itemSelected",function(d){e.CHM(i);const f=e.oxw(2);return e.KtG(f.itemSelected(d))}),e.ynx(1,18),e.YNc(2,ie,2,0,"th",19),e.YNc(3,ne,2,1,"td",20),e.BQk(),e.ynx(4,21),e.YNc(5,se,2,0,"th",22),e.YNc(6,re,2,1,"td",23),e.BQk(),e.ynx(7,24),e.YNc(8,oe,2,0,"th",19),e.YNc(9,ce,2,1,"td",23),e.BQk(),e.ynx(10,25),e.YNc(11,ae,2,0,"th",19),e.YNc(12,le,2,1,"td",23),e.BQk(),e.ynx(13,26),e.YNc(14,de,2,0,"th",19),e.YNc(15,pe,2,2,"td",23),e.BQk(),e.ynx(16,27),e.YNc(17,ue,2,0,"th",19),e.YNc(18,me,2,1,"td",23),e.BQk(),e.ynx(19,28),e.YNc(20,he,2,0,"th",19),e.YNc(21,fe,2,1,"td",23),e.BQk(),e.ynx(22,29),e.YNc(23,_e,2,0,"th",19),e.YNc(24,ge,3,4,"td",23),e.BQk(),e.ynx(25,30),e.YNc(26,ve,2,0,"th",19),e.YNc(27,Ce,3,4,"td",23),e.BQk(),e.ynx(28,31),e.YNc(29,Ie,2,0,"th",19),e.YNc(30,Se,3,4,"td",23),e.BQk(),e.qZA()}if(2&t){const i=n.ngIf,o=e.oxw(2);e.Q6J("items",i)("headers",o.headerTable)("selectable",!0)}}function Ye(t,n){if(1&t){const i=e.EpF();e.TgZ(0,"app-crud-list",3),e.NdJ("searchButtonClicked",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.searchButtonClicked())})("refreshButtonClicked",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.refreshButtonClicked())})("pageSelected",function(d){e.CHM(i);const f=e.oxw();return e.KtG(f.pageSelected(d))})("pageSizeChange",function(d){e.CHM(i);const f=e.oxw();return e.KtG(f.pageSizeChange(d))})("closeButtonClicked",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.closeButtonClicked())}),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6),e._UZ(4,"app-form-label",7),e.qZA(),e.TgZ(5,"div",8),e._UZ(6,"app-custom-textfield",9),e.qZA()()(),e._UZ(7,"div",10)(8,"div",11),e.TgZ(9,"div",12),e._UZ(10,"app-custom-button",13),e.TgZ(11,"app-print-button",14),e.NdJ("printButtonClicked",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.printButtonClicked())}),e.qZA()(),e.TgZ(12,"div",15),e.YNc(13,Ne,31,3,"table",16),e.ALo(14,"async"),e.qZA()()}if(2&t){const i=n.ngIf,o=e.oxw();e.Q6J("itemSelected",o.isItemSelected())("pageSize",i.pageSize)("currentPage",i.page)("totalElements",i.totalElement),e.xp6(1),e.Q6J("formGroup",o.searchForm),e.xp6(6),e.Q6J("formGroup",o.searchForm),e.xp6(6),e.Q6J("ngIf",e.lcZ(14,7,o.items$))}}let Ze=(()=>{class t{constructor(i,o,d){this.router=i,this.store=o,this.incidentFormService=d,this.isUpdateActivated=!1,this.headerTable=["R\xe9f\xe9rence","Libell\xe9 Demande","Equipement","Statut","Priorit\xe9","S\xe9v\xe9rit\xe9","Impact","Demandeur","service/unit.Fonct","Date Cr\xe9ation","Date Rejet","Date Dern modif"],this.items$=this.store.select(z),this.page$=this.store.select($),this.pageSize$=this.store.select(M),this.totalElement$=this.store.select(O),this.data$=(0,F.a)([this.page$,this.pageSize$,this.totalElement$]).pipe((0,_.U)(([f,T,j])=>({page:f,pageSize:T,totalElement:j}))),this.selectedItem=null}ngOnInit(){this.searchForm=this.incidentFormService.createSearchForm(),this.store.dispatch(r.NY.loadItems())}validateButtonClicked(){const i=this.selectedItem?.id;i&&(this.store.dispatch(r.NY.resetItem()),this.router.navigate(["incidents","incidents-rejetes","validate",i]))}itemSelected(i){this.selectedItem=i}pageSelected(i){this.store.dispatch(r.NY.changePage({page:i}))}pageSizeChange(i){this.store.dispatch(r.NY.changePageSize({pageSize:i}))}closeButtonClicked(){this.router.navigate(["incidents"])}isItemSelected(){return null!==this.selectedItem}refreshButtonClicked(){this.searchForm.reset(),this.store.dispatch(r.NY.resetSearch())}searchButtonClicked(){this.store.dispatch(r.NY.search({searchModel:this.searchForm.value}))}printButtonClicked(){}static#e=this.\u0275fac=function(o){return new(o||t)(e.Y36(Z.F0),e.Y36(c.yh),e.Y36(R.X))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-incident-rejete-list"]],features:[e._Bn([R.X,D.x,B.W,U.P])],decls:4,vars:3,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Support IT","pathLevelTwo","Incidents Rejet\xe9s","pathLevelThree","Liste"],["title","Liste des Incidents Rej\xe9t\xe9s",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked",4,"ngIf"],["title","Liste des Incidents Rej\xe9t\xe9s",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked"],[1,"normal-search",3,"formGroup"],[1,"d-flex","flex-row","align-items-center"],[1,"text-end","me-1","width-label-search"],["title","Libell\xe9"],[1,"input-textfield-container","col-3"],["placeholder","","otherclass","item-input","formControlName","titre"],[1,"advance-search",3,"formGroup"],[1,"primary-actions"],[1,"secondary-actions","d-flex"],["customClass","btn btn-sm button-action","title","Exporter","url","export.svg",1,"me-1","ms-1"],[3,"printButtonClicked"],[1,"table-content"],["appDynamicTable","",3,"items","headers","selectable","itemSelected",4,"ngIf"],["appDynamicTable","",3,"items","headers","selectable","itemSelected"],["appCellDef","R\xe9f\xe9rence"],["app-header-attribute-def-template","",4,"appHeaderDefTemplate"],["app-cell-def-template","",4,"appCellDefTemplate"],["appCellDef","Libell\xe9 Demande"],["app-header-attribute-def-template","","class","width-35",4,"appHeaderDefTemplate"],["app-cell-def-template","","class","left",4,"appCellDefTemplate"],["appCellDef","Equipement"],["appCellDef","Statut"],["appCellDef","Demandeur"],["appCellDef","Priorit\xe9"],["appCellDef","S\xe9v\xe9rit\xe9"],["appCellDef","Date Cr\xe9ation"],["appCellDef","Date Rejet"],["appCellDef","Date Dern modif"],["app-header-attribute-def-template",""],["app-cell-def-template",""],["app-header-attribute-def-template","",1,"width-35"],["app-cell-def-template","",1,"left"]],template:function(o,d){1&o&&(e.TgZ(0,"div",0),e._UZ(1,"app-custom-breadcrumb",1),e.qZA(),e.YNc(2,Ye,15,9,"app-crud-list",2),e.ALo(3,"async")),2&o&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,d.data$)))},dependencies:[S.O5,y.L,N.JJ,N.JL,N.sg,N.u,Q._,H.x,K.N,W.D,J.h,V.u,X.O,k.q,q.W,w.h,ee.Z,te.V,S.Ov,S.uU],styles:["[_nghost-%COMP%]{width:100%}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}.left[_ngcontent-%COMP%]{text-align:left!important}"]})}return t})();var xe=s(8510),a=s(6465),Te=s(9207),je=s(1793),Ee=s(3396),Le=s(2030),m=s(6063),Re=s(9862),$e=s(2460),v=s(6328),Me=s(9026),C=s(6306),x=s(9397),ye=s(1631),h=s(2096),Ae=s(3186),Be=s(4664),Ue=s(9989),De=s(1946);let A=(()=>{class t extends Ue.v{getResourceBasePath(){return`${De.y}/support-incident-rejete`}getIdValue(i){return i.id}static#e=this.\u0275fac=function(){let i;return function(d){return(i||(i=e.n5z(t)))(d||t)}}();static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac})}return t})();var Fe=s(6366),Pe=s(797);let be=(()=>{class t{constructor(i,o,d,f,T,j){this.incidentRejeteService=i,this.authService=o,this.actions$=d,this.router=f,this.modalService=T,this.store=j,this.loadItems$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.loadItems),(0,$e.M)(this.store.select($),this.store.select(M),this.store.select(G)),(0,v.b)(([l,p,Y,E])=>(console.log(p),this.store.dispatch((0,m.Q)()),(0,Me.$)(this.incidentRejeteService.getAllWithPagination(p,Y,E),this.incidentRejeteService.count(E)).pipe((0,_.U)(([I,Oe])=>(this.store.dispatch((0,m.Z)()),r.NY.loadItemsSuccess({items:I,totalElement:Oe}))),(0,C.K)(I=>(this.store.dispatch((0,m.Z)()),(0,h.of)(r.NY.setError({errors:I})))))))),{dispatch:!0}),this.createItem$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.createItem),(0,v.b)(l=>(this.store.dispatch((0,m.Q)()),console.log(l.item),this.incidentRejeteService.add(l.item).pipe((0,x.b)(()=>{this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident ajout\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/incidents-rejetes")}),(0,_.U)(p=>r.NY.createItemSuccess({item:p})),(0,C.K)(p=>(this.store.dispatch((0,m.Z)()),(0,h.of)(r.NY.setError({errors:p})))))))),{dispatch:!0}),this.loadItem$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.loadItem),(0,ye.z)(l=>this.incidentRejeteService.findById(l.id).pipe((0,_.U)(p=>r.NY.loadItemSuccess({item:p})),(0,C.K)(p=>(this.store.dispatch((0,m.Z)()),(0,h.of)(r.NY.setError({errors:p}))))))),{dispatch:!0}),this.deleteItem$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.deleteItem),(0,v.b)(l=>this.incidentRejeteService.delete(l.item.id,l.item)),(0,x.b)(()=>{this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident supprim\xe9 avec succ\xe8s"})}),(0,_.U)(()=>r.NY.loadItems()),(0,C.K)(l=>(this.store.dispatch((0,m.Z)()),(0,h.of)(r.NY.setError({errors:l}))))),{dispatch:!0}),this.updateItem$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.updateItem),(0,v.b)(l=>(this.store.dispatch((0,m.Q)()),this.incidentRejeteService.update(l.item.id,l.item).pipe((0,x.b)(()=>{this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident modifi\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/incidents-rejetes")}),(0,_.U)(p=>r.NY.createItemSuccess({item:p})),(0,C.K)(p=>(this.store.dispatch((0,m.Z)()),(0,h.of)(r.NY.setError({errors:p})))))))),{dispatch:!0}),this.loadFormModel$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.loadFormModel),(0,v.b)(()=>this.incidentRejeteService.getFormModel()),(0,_.U)(l=>r.NY.loadFormModelSuccess({formModel:l})),(0,C.K)(l=>(0,h.of)(r.NY.setError({errors:l}))))),this.resetSearch$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.resetSearch),(0,v.b)(()=>(0,h.of)(r.NY.changePage({page:1}))))),this.search$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.search),(0,v.b)(()=>(0,h.of)(r.NY.changePage({page:1}))))),this.changePage$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.changePage),(0,_.U)(l=>r.NY.loadItems()))),this.changePageSize$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.changePageSize),(0,v.b)(()=>(0,h.of)(r.NY.changePage({page:1}))))),this.handleError$=(0,a.GW)(()=>this.actions$.pipe((0,a.l4)(r.NY.setError),(0,Be.w)(l=>{if(this.store.dispatch((0,m.Q)()),l.errors instanceof Re.UA){if(422===l.errors.status){let p="",Y=0;for(const[E,I]of Object.entries(l.errors.error))p+=0===Y?I:"\n"+I,Y++;this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:p})}if(403===l.errors.status&&this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:"Vous n'avez pas le droit requis pour effectuer cette action"}),401===l.errors.status){let p="Votre token a expir\xe9, veuillez vous reconnecter svp!";return this.authService.removeToken(),this.authService.removeUserInfo(),this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:p}),(0,h.of)(Ae.jM())}}return this.store.dispatch((0,m.Z)()),(0,h.of)({type:"noop"})})),{dispatch:!0})}static#e=this.\u0275fac=function(o){return new(o||t)(e.LFG(A),e.LFG(Fe.e),e.LFG(a.eX),e.LFG(Z.F0),e.LFG(Pe.Z),e.LFG(c.yh))};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac})}return t})();const ze=[{path:"",component:Ze,pathMatch:"prefix"}];let Ge=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275mod=e.oAB({type:t});static#i=this.\u0275inj=e.cJS({providers:[A],imports:[S.ez,y.L,c.Aw.forFeature("incident-rejetes",b),a.sQ.forFeature(be),xe.Y,Le.h,Ee.B,je.K,Te.m,Z.Bz.forChild(ze)]})}return t})()}}]);