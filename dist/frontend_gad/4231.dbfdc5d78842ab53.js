"use strict";(self.webpackChunkfrontend_gad=self.webpackChunkfrontend_gad||[]).push([[4231],{4231:(Pt,$,o)=>{o.r($),o.d($,{IncidentReaffecteModule:()=>Tt});var S=o(6814),E=o(8281),B=o(2572),g=o(7398),s=o(676);const u="Incident Reaffecte",U=(0,s.PH)(`[${u} API] Load All`),K=(0,s.PH)(`[${u} API] Load All Success`,(0,s.Ky)()),H=(0,s.PH)(`[${u} API] Create`,(0,s.Ky)()),G=(0,s.PH)(`[${u} API] Create Success`,(0,s.Ky)()),Q=(0,s.PH)(`[${u} API] Load`,(0,s.Ky)()),O=(0,s.PH)(`[${u} API] Reset`),z=(0,s.PH)(`[${u} API] Load Success`,(0,s.Ky)()),Y=(0,s.PH)(`[${u} API] Delete`,(0,s.Ky)()),q=(0,s.PH)(`[${u} API] Delete Success`,(0,s.Ky)()),J=(0,s.PH)(`[${u} API] Reaffecte`,(0,s.Ky)()),V=(0,s.PH)(`[${u} API] Reaffecte Success`,(0,s.Ky)()),W=(0,s.PH)(`[${u} API] Update`,(0,s.Ky)()),j=(0,s.PH)(`[${u} API] Update Success`,(0,s.Ky)()),X=(0,s.PH)(`[${u} API] Load Form Model`),k=(0,s.PH)(`[${u} API] Reset Form Model`),w=(0,s.PH)(`[${u} API] Load Form Model Success`,(0,s.Ky)()),ee=(0,s.PH)(`[${u} API] Reset Search`),te=(0,s.PH)(`[${u} API] Search`,(0,s.Ky)()),ne=(0,s.PH)(`[${u} API] Change Page`,(0,s.Ky)()),ie=(0,s.PH)(`[${u} API] Change Page Size`,(0,s.Ky)()),c={loadItems:U,loadItemsSuccess:K,resetItem:O,createItem:H,createItemSuccess:G,loadItem:Q,loadItemSuccess:z,updateItem:W,updateItemSuccess:j,reaffecteItem:J,reaffecteItemSuccess:V,deleteItem:Y,deleteItemSuccess:q,loadFormModel:X,resetFormModel:k,loadFormModelSuccess:w,setError:(0,s.PH)(`[${u} API] Create Error`,(0,s.Ky)()),resetError:(0,s.PH)(`[${u} API] Reset Error`),resetErrorField:(0,s.PH)(`[${u} API] Reset Error Field`,(0,s.Ky)()),resetSearch:ee,search:te,changePage:ne,changePageSize:ie},ae=(0,s.Lq)({formModel:null,searchModel:{},items:[],currentItem:null,page:1,pageSize:15,totalElement:0,errors:null},(0,s.on)(c.loadItemsSuccess,(n,r)=>({...n,items:r.items,totalElement:r.totalElement})),(0,s.on)(c.resetItem,(n,r)=>({...n,currentItem:null})),(0,s.on)(c.createItemSuccess,(n,r)=>({...n})),(0,s.on)(c.deleteItemSuccess,(n,r)=>({...n})),(0,s.on)(c.loadItemSuccess,(n,r)=>({...n,currentItem:r.item})),(0,s.on)(c.updateItemSuccess,(n,r)=>({...n})),(0,s.on)(c.reaffecteItemSuccess,(n,r)=>({...n})),(0,s.on)(c.loadFormModel,(n,r)=>({...n,formModel:null})),(0,s.on)(c.loadFormModelSuccess,(n,r)=>({...n,formModel:r.formModel})),(0,s.on)(c.resetSearch,(n,r)=>({...n,searchModel:{}})),(0,s.on)(c.search,(n,r)=>({...n,searchModel:r.searchModel})),(0,s.on)(c.changePage,(n,r)=>({...n,page:r.page})),(0,s.on)(c.changePageSize,(n,r)=>({...n,pageSize:r.pageSize})),(0,s.on)(c.setError,(n,r)=>({...n,errors:r.errors})),(0,s.on)(c.resetError,(n,r)=>({...n,errors:{}})),(0,s.on)(c.resetErrorField,(n,r)=>{let t={};return null!==n.errors&&Object.entries(n.errors).forEach(([i,a])=>{i!==r.fieldName&&(t[`${i}`]=a)}),{...n,errors:t}})),C=(0,s.ZF)("incident-reaffectes"),de=(0,s.P1)(C,n=>n.items),le=(0,s.P1)(C,n=>n.currentItem),pe=(0,s.P1)(C,n=>n.formModel),ue=(0,s.P1)(C,n=>n.searchModel),L=(0,s.P1)(C,n=>n.page),b=(0,s.P1)(C,n=>n.pageSize),fe=(0,s.P1)(C,n=>n.totalElement),me=(0,s.P1)(C,n=>n.errors);var D=o(3096),he=o(4970),_e=o(3975),ge=o(5779),e=o(9468),M=o(3849),P=o(95),Ie=o(7251),Ce=o(166),Se=o(6327),xe=o(8564),Te=o(8223),Ee=o(602),Pe=o(1469),Re=o(6326),Ze=o(8346),ye=o(1171),Ae=o(547),N=o(362);function ve(n,r){1&n&&(e.TgZ(0,"th",33),e._uU(1,"R\xe9f\xe9rence"),e.qZA())}const _=function(n){return{"alert-echeance":n}};function $e(n,r){if(1&n&&(e.TgZ(0,"td",34),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(2,_,i.isDueDate(t))),e.xp6(1),e.Oqu(t.refSys)}}function Le(n,r){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Cat\xe9gorie"),e.qZA())}function be(n,r){if(1&n&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(2,_,i.isDueDate(t))),e.xp6(1),e.Oqu(null==t.categorieIncident?null:t.categorieIncident.code)}}function De(n,r){1&n&&(e.TgZ(0,"th",36),e._uU(1,"Libell\xe9 Demande"),e.qZA())}function Me(n,r){if(1&n&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(2,_,i.isDueDate(t))),e.xp6(1),e.Oqu(t.titre)}}function Ne(n,r){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Equipement"),e.qZA())}function Fe(n,r){if(1&n&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(2,_,i.isDueDate(t))),e.xp6(1),e.Oqu(t.equipement.libelle)}}function Be(n,r){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Statut"),e.qZA())}function Ue(n,r){if(1&n&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(2,_,i.isDueDate(t))),e.xp6(1),e.Oqu(t.statutIncident)}}function Ke(n,r){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Emis Par"),e.qZA())}function He(n,r){if(1&n&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(3,_,i.isDueDate(t))),e.xp6(1),e.AsE("",null==t.demandeur?null:t.demandeur.firstName," ",null==t.demandeur?null:t.demandeur.lastName,"")}}function Ge(n,r){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Affect\xe9 \xe0"),e.qZA())}function Qe(n,r){if(1&n&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(3,_,i.isDueDate(t))),e.xp6(1),e.AsE("",null==t.gestionnaire?null:t.gestionnaire.firstName," ",null==t.gestionnaire?null:t.gestionnaire.lastName,"")}}function Oe(n,r){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Priorit\xe9"),e.qZA())}function ze(n,r){if(1&n&&(e.TgZ(0,"td",35),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(2,_,i.isDueDate(t))),e.xp6(1),e.Oqu(t.prioriteIncident)}}function Ye(n,r){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Date Cr\xe9ation"),e.qZA())}function qe(n,r){if(1&n&&(e.TgZ(0,"td",35),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(5,_,i.isDueDate(t))),e.xp6(1),e.Oqu(e.xi3(2,2,t.dateCreation,"dd/MM/y \xe0 HH:mm:ss"))}}function Je(n,r){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Date Derni\xe8re Modif"),e.qZA())}function Ve(n,r){if(1&n&&(e.TgZ(0,"td",35),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(5,_,i.isDueDate(t))),e.xp6(1),e.Oqu(e.xi3(2,2,t.dateDerniereModification,"dd/MM/y \xe0 HH:mm:ss"))}}function We(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"table",18),e.NdJ("itemSelected",function(a){e.CHM(t);const m=e.oxw(2);return e.KtG(m.itemSelected(a))}),e.ynx(1,19),e.YNc(2,ve,2,0,"th",20),e.YNc(3,$e,2,4,"td",21),e.BQk(),e.ynx(4,22),e.YNc(5,Le,2,0,"th",20),e.YNc(6,be,2,4,"td",23),e.BQk(),e.ynx(7,24),e.YNc(8,De,2,0,"th",25),e.YNc(9,Me,2,4,"td",23),e.BQk(),e.ynx(10,26),e.YNc(11,Ne,2,0,"th",20),e.YNc(12,Fe,2,4,"td",23),e.BQk(),e.ynx(13,27),e.YNc(14,Be,2,0,"th",20),e.YNc(15,Ue,2,4,"td",23),e.BQk(),e.ynx(16,28),e.YNc(17,Ke,2,0,"th",20),e.YNc(18,He,2,5,"td",23),e.BQk(),e.ynx(19,29),e.YNc(20,Ge,2,0,"th",20),e.YNc(21,Qe,2,5,"td",23),e.BQk(),e.ynx(22,30),e.YNc(23,Oe,2,0,"th",20),e.YNc(24,ze,2,4,"td",23),e.BQk(),e.ynx(25,31),e.YNc(26,Ye,2,0,"th",20),e.YNc(27,qe,3,7,"td",23),e.BQk(),e.ynx(28,32),e.YNc(29,Je,2,0,"th",20),e.YNc(30,Ve,3,7,"td",23),e.BQk(),e.qZA()}if(2&n){const t=r.ngIf,i=e.oxw(2);e.Q6J("items",t)("headers",i.headerTable)("selectable",!0)}}function je(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"app-crud-list",3),e.NdJ("searchButtonClicked",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.searchButtonClicked())})("refreshButtonClicked",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.refreshButtonClicked())})("pageSelected",function(a){e.CHM(t);const m=e.oxw();return e.KtG(m.pageSelected(a))})("pageSizeChange",function(a){e.CHM(t);const m=e.oxw();return e.KtG(m.pageSizeChange(a))})("closeButtonClicked",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.closeButtonClicked())}),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6),e._UZ(4,"app-form-label",7),e.qZA(),e.TgZ(5,"div",8),e._UZ(6,"app-custom-textfield",9),e.qZA()()(),e._UZ(7,"div",10),e.TgZ(8,"div",11)(9,"app-custom-button",12),e.NdJ("buttonClicked",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.reaffectButtonClicked())}),e.qZA()(),e.TgZ(10,"div",13),e._UZ(11,"app-custom-button",14),e.TgZ(12,"app-print-button",15),e.NdJ("printButtonClicked",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.printButtonClicked())}),e.qZA()(),e.TgZ(13,"div",16),e.YNc(14,We,31,3,"table",17),e.ALo(15,"async"),e.qZA()()}if(2&n){const t=r.ngIf,i=e.oxw();e.Q6J("itemSelected",i.isItemSelected())("pageSize",t.pageSize)("currentPage",t.page)("totalElements",t.totalElement),e.xp6(1),e.Q6J("formGroup",i.searchForm),e.xp6(6),e.Q6J("formGroup",i.searchForm),e.xp6(2),e.Q6J("disabled",!i.isItemSelected()),e.xp6(5),e.Q6J("ngIf",e.lcZ(15,8,i.items$))}}let Xe=(()=>{class n{constructor(t,i,a){this.router=t,this.store=i,this.incidentFormService=a,this.isUpdateActivated=!1,this.headerTable=["R\xe9f\xe9rence","Cat & sous-categorie","Libell\xe9 Demande","Equipement","Statut","Priorit\xe9","S\xe9v\xe9rit\xe9","Impact","Demandeur","Gestionnaire","service/unit.Fonct","Date Cr\xe9ation","Date Dern modif"],this.items$=this.store.select(de),this.page$=this.store.select(L),this.pageSize$=this.store.select(b),this.totalElement$=this.store.select(fe),this.data$=(0,B.a)([this.page$,this.pageSize$,this.totalElement$]).pipe((0,g.U)(([m,y,A])=>({page:m,pageSize:y,totalElement:A}))),this.selectedItem=null,this.actualDate=0}ngOnInit(){this.searchForm=this.incidentFormService.createSearchForm(),this.store.dispatch(c.loadItems()),this.actualDate=Date.now()}isDueDate(t){if(null!==t&&null!==t.statutIncident){if(console.log(t),console.log(this.actualDate),"En cours de r\xe9solution"===t.statutIncident)return Number(t.dateEcheanceEnCoursResolution)-this.actualDate<=0;if("R\xe9solu"===t.statutIncident)return Number(t.dateEcheanceResolution)-this.actualDate<=0;if("Clos"===t.statutIncident)return Number(t.dateEcheanceCloture)-this.actualDate<=0}}reaffectButtonClicked(){const t=this.selectedItem?.id;t&&(this.store.dispatch(c.resetItem()),this.router.navigate(["incidents","incident-reaffecte","reaffect",t]))}itemSelected(t){this.selectedItem=t}pageSelected(t){this.store.dispatch(c.changePage({page:t}))}pageSizeChange(t){this.store.dispatch(c.changePageSize({pageSize:t}))}closeButtonClicked(){this.router.navigate(["incidents"])}isItemSelected(){return null!==this.selectedItem}refreshButtonClicked(){this.searchForm.reset(),this.store.dispatch(c.resetSearch())}searchButtonClicked(){this.store.dispatch(c.search({searchModel:this.searchForm.value}))}printButtonClicked(){}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(E.F0),e.Y36(s.yh),e.Y36(D.X))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-incident-reaffect-list"]],features:[e._Bn([D.X,_e.x,he.W,ge.P])],decls:4,vars:3,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Supervision Incident","pathLevelTwo","Incident \xe0 R\xe9affecter","pathLevelThree","Liste"],["title","Liste des Incidents \xe0 R\xe9affecter",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked",4,"ngIf"],["title","Liste des Incidents \xe0 R\xe9affecter",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked"],[1,"normal-search",3,"formGroup"],[1,"d-flex","flex-row","align-items-center"],[1,"text-end","me-1","width-label-search"],["title","Libell\xe9"],[1,"input-textfield-container","col-3"],["placeholder","","otherclass","item-input","formControlName","titre"],[1,"advance-search",3,"formGroup"],[1,"primary-actions"],["icon","icon-check btn-icon-add","title","R\xe9affecter",1,"me-1",3,"disabled","buttonClicked"],[1,"secondary-actions","d-flex"],["customClass","btn btn-sm button-action","title","Exporter","url","export.svg",1,"me-1","ms-1"],[3,"printButtonClicked"],[1,"table-content"],["appDynamicTable","",3,"items","headers","selectable","itemSelected",4,"ngIf"],["appDynamicTable","",3,"items","headers","selectable","itemSelected"],["appCellDef","R\xe9f\xe9rence"],["app-header-attribute-def-template","",4,"appHeaderDefTemplate"],["app-cell-def-template","","class","text-start",3,"ngClass",4,"appCellDefTemplate"],["appCellDef","Cat & sous-categorie"],["app-cell-def-template","","class","left",3,"ngClass",4,"appCellDefTemplate"],["appCellDef","Libell\xe9 Demande"],["app-header-attribute-def-template","","class","width-30",4,"appHeaderDefTemplate"],["appCellDef","Equipement"],["appCellDef","Statut"],["appCellDef","Demandeur"],["appCellDef","Gestionnaire"],["appCellDef","Priorit\xe9"],["appCellDef","Date Cr\xe9ation"],["appCellDef","Date Modification"],["app-header-attribute-def-template",""],["app-cell-def-template","",1,"text-start",3,"ngClass"],["app-cell-def-template","",1,"left",3,"ngClass"],["app-header-attribute-def-template","",1,"width-30"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"app-custom-breadcrumb",1),e.qZA(),e.YNc(2,je,16,10,"app-crud-list",2),e.ALo(3,"async")),2&i&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,a.data$)))},dependencies:[S.mk,S.O5,M.L,P.JJ,P.JL,P.sg,P.u,Ie._,Ce.x,Se.N,xe.D,Te.h,Ee.u,Pe.O,Re.q,Ze.W,ye.h,Ae.Z,N.V,S.Ov,S.uU],styles:["[_nghost-%COMP%]{width:100%}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}.left[_ngcontent-%COMP%]{text-align:left!important}.alert-echeance[_ngcontent-%COMP%]{background-color:#f5c2c7!important}"]})}return n})();var ke=o(7394),we=o(4557),et=o(5002),tt=o(3936);function nt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"app-incident-form",4),e.NdJ("formSubmitted",function(a){e.CHM(t);const m=e.oxw(2);return e.KtG(m.reaffectIncident(a))})("returnToList",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.returnToList())})("fieldReset",function(a){e.CHM(t);const m=e.oxw(2);return e.KtG(m.resetBackendError(a))}),e.qZA()}if(2&n){const t=e.oxw().ngIf,i=e.oxw();e.Q6J("incident",i.itemIncident)("formModel",t)("roleIncident",i.roleIncident)("errors",i.error)("reaffectedValue",i.reaffectedValue)}}function it(n,r){if(1&n&&(e.ynx(0),e.YNc(1,nt,1,5,"app-incident-form",3),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.itemIncident)}}let st=(()=>{class n{constructor(t,i,a){this.store=t,this.route=i,this.router=a,this.formModel$=this.store.select(pe),this.incident$=this.store.select(le),this.itemIncident=null,this.errors$=this.store.select(me),this.error={},this.operationType=we.C.REAFFECT,this.roleIncident=et.s.SUPERVISOR,this.reaffectedValue=1,this.subscription=new ke.w0}ngOnInit(){this.store.dispatch(c.resetFormModel()),this.subscription=this.route.params.subscribe(t=>{this.id=t.id,this.id&&this.store.dispatch(c.loadItem({id:this.id}))}),this.store.dispatch(c.resetItem()),this.store.dispatch(c.loadFormModel()),this.errors$.subscribe(t=>{null!==t&&(this.error=t)}),this.incident$.subscribe(t=>{t&&(console.log(t.demandeur),this.itemIncident={id:t.id,titre:t.titre,description:t.description,categorieIncident:t.categorieIncident,probleme:t.probleme,refSys:t.refSys,etapeIncident:t.statutIncident,firstName:null==t.demandeur?"":t.demandeur.firstName,lastName:null==t.demandeur?"":t.demandeur.lastName,userName:null==t.demandeur?"":t.demandeur.userName,demandeur:t.demandeur,firstNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.firstName,lastNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.lastName,userNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.userName,firstNameSupport:null==t.gestionnaire?"":t.gestionnaire.firstName,lastNameSupport:null==t.gestionnaire?"":t.gestionnaire.lastName,userNameSupport:null==t.gestionnaire?"":t.gestionnaire.userName,gestionnaire:t.gestionnaire,test:null,impact:t.impact,equipement:t.equipement,groupeEquipement:null==t.equipement?"":t.equipement.modelEquip.categoryEquip.groupEquip.libelle,categorieEquipement:null==t.equipement?"":t.equipement.modelEquip.categoryEquip.libelle,sousCategorieEquipement:"",libelleEquipement:null==t.equipement?"":t.equipement.libelle,numeroSerie:null==t.equipement?"":t.equipement.numeroSerie,source:t.source,severite:t.severite,statutIncident:t.statutIncident,prioriteIncident:t.prioriteIncident,typeIncident:t.typeIncident,dateDerniereModification:null===t.dateDerniereModification?"":this.formatDate(t.dateDerniereModification),dateCreation:null===t.dateCreation?"":this.formatDate(t.dateCreation)})})}formatDate(t){if(t){const i=new Date(t);return i.toLocaleDateString()+" \xe0 "+i.toLocaleTimeString()}return null}ngOnDestroy(){this.subscription.unsubscribe()}reaffectIncident(t){const i={id:t.id,titre:t.titre,description:t.description,equipement:t.equipement,typeIncident:t.typeIncident,probleme:t.probleme,categorieIncident:t.categorieIncident,gestionnaire:t.gestionnaire,impact:t.impact,prioriteIncident:t.prioriteIncident,source:t.source,severite:t.severite};this.store.dispatch(c.reaffecteItem({id:Number(this.id),item:i}))}resetBackendError(t){console.log(t),this.store.dispatch(c.resetErrorField({fieldName:t}))}returnToList(){this.router.navigateByUrl("incidents/incident-reaffecte")}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(s.yh),e.Y36(E.gz),e.Y36(E.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-incident-reaffect-add"]],decls:4,vars:3,consts:[[1,"ps-3","pb-0","mb-0"],["pathLevelOne","Supervision Incident","pathLevelTwo","Incident \xe0 R\xe9affecter","pathLevelThree","R\xe9affecter"],[4,"ngIf"],[3,"incident","formModel","roleIncident","errors","reaffectedValue","formSubmitted","returnToList","fieldReset",4,"ngIf"],[3,"incident","formModel","roleIncident","errors","reaffectedValue","formSubmitted","returnToList","fieldReset"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"app-custom-breadcrumb",1),e.qZA(),e.YNc(2,it,2,1,"ng-container",2),e.ALo(3,"async")),2&i&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,a.formModel$)))},dependencies:[S.O5,tt.u,N.V,S.Ov],styles:["[_nghost-%COMP%]{width:100%}"]})}return n})();var l=o(6465),rt=o(2460),I=o(6328),ct=o(9026),x=o(6306),R=o(9397),ot=o(1631),f=o(6063),at=o(9862),h=o(2096),dt=o(3186),lt=o(4664),pt=o(9989),ut=o(1946);let F=(()=>{class n extends pt.v{getResourceBasePath(){return`${ut.y}/supervision-incident-reaffecter`}reaffecter(t,i){return this.http.post(`${this.url}/${this.getResourceBasePath()}/reaffecter/${t}`,i)}static#e=this.\u0275fac=function(){let t;return function(a){return(t||(t=e.n5z(n)))(a||n)}}();static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac})}return n})();var ft=o(6366),mt=o(797);let ht=(()=>{class n{constructor(t,i,a,m,y,A){this.incidentReaffecteService=t,this.authService=i,this.actions$=a,this.router=m,this.modalService=y,this.store=A,this.loadItems$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.loadItems),(0,rt.M)(this.store.select(L),this.store.select(b),this.store.select(ue)),(0,I.b)(([d,p,Z,v])=>(console.log(p),this.store.dispatch((0,f.Q)()),(0,ct.$)(this.incidentReaffecteService.getAllWithPagination(p,Z,v),this.incidentReaffecteService.count(v)).pipe((0,g.U)(([T,Et])=>(this.store.dispatch((0,f.Z)()),c.loadItemsSuccess({items:T,totalElement:Et}))),(0,x.K)(T=>(this.store.dispatch((0,f.Z)()),(0,h.of)(c.setError({errors:T})))))))),{dispatch:!0}),this.createItem$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.createItem),(0,I.b)(d=>(this.store.dispatch((0,f.Q)()),console.log(d.item),this.incidentReaffecteService.add(d.item).pipe((0,R.b)(()=>{this.store.dispatch((0,f.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident ajout\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/incident-reaffecte")}),(0,g.U)(p=>c.createItemSuccess({item:p})),(0,x.K)(p=>(this.store.dispatch((0,f.Z)()),(0,h.of)(c.setError({errors:p})))))))),{dispatch:!0}),this.loadItem$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.loadItem),(0,ot.z)(d=>this.incidentReaffecteService.findById(d.id).pipe((0,g.U)(p=>c.loadItemSuccess({item:p})),(0,x.K)(p=>(this.store.dispatch((0,f.Z)()),(0,h.of)(c.setError({errors:p}))))))),{dispatch:!0}),this.deleteItem$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.deleteItem),(0,I.b)(d=>this.incidentReaffecteService.delete(d.item.id,d.item)),(0,R.b)(()=>{this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident supprim\xe9 avec succ\xe8s"})}),(0,g.U)(()=>c.loadItems()),(0,x.K)(d=>(this.store.dispatch((0,f.Z)()),(0,h.of)(c.setError({errors:d}))))),{dispatch:!0}),this.updateItem$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.updateItem),(0,I.b)(d=>(this.store.dispatch((0,f.Q)()),this.incidentReaffecteService.update(d.id,d.item).pipe((0,R.b)(()=>{this.store.dispatch((0,f.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident modifi\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/incident-reaffecte")}),(0,g.U)(p=>c.createItemSuccess({item:p})),(0,x.K)(p=>(this.store.dispatch((0,f.Z)()),(0,h.of)(c.setError({errors:p})))))))),{dispatch:!0}),this.reaffecteItem$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.reaffecteItem),(0,I.b)(d=>(this.store.dispatch((0,f.Q)()),this.incidentReaffecteService.reaffecter(d.id,d.item).pipe((0,R.b)(()=>{this.store.dispatch((0,f.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident R\xe9affect\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/incident-reaffecte")}),(0,g.U)(p=>c.reaffecteItemSuccess({item:p})),(0,x.K)(p=>(this.store.dispatch((0,f.Z)()),(0,h.of)(c.setError({errors:p})))))))),{dispatch:!0}),this.loadFormModel$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.loadFormModel),(0,I.b)(()=>this.incidentReaffecteService.getFormModel()),(0,g.U)(d=>c.loadFormModelSuccess({formModel:d})),(0,x.K)(d=>(0,h.of)(c.setError({errors:d}))))),this.resetSearch$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.resetSearch),(0,I.b)(()=>(0,h.of)(c.changePage({page:1}))))),this.search$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.search),(0,I.b)(()=>(0,h.of)(c.changePage({page:1}))))),this.changePage$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.changePage),(0,g.U)(d=>c.loadItems()))),this.changePageSize$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.changePageSize),(0,I.b)(()=>(0,h.of)(c.changePage({page:1}))))),this.handleError$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.setError),(0,lt.w)(d=>{if(this.store.dispatch((0,f.Q)()),d.errors instanceof at.UA){if(422===d.errors.status){let p="",Z=0;for(const[v,T]of Object.entries(d.errors.error))p+=0===Z?T:"\n"+T,Z++;this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:p})}if(403===d.errors.status&&this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:"Vous n'avez pas le droit requis pour effectuer cette action"}),401===d.errors.status){let p="Votre token a expir\xe9, veuillez vous reconnecter svp!";return this.authService.removeToken(),this.authService.removeUserInfo(),this.store.dispatch((0,f.Z)()),this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:p}),(0,h.of)(dt.jM())}}return this.store.dispatch((0,f.Z)()),(0,h.of)({type:"noop"})})),{dispatch:!0})}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(F),e.LFG(ft.e),e.LFG(l.eX),e.LFG(E.F0),e.LFG(mt.Z),e.LFG(s.yh))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac})}return n})();var _t=o(8510),gt=o(2030),It=o(3396),Ct=o(1793),St=o(9207);const xt=[{path:"",component:Xe,pathMatch:"prefix"},{path:"reaffect/:id",component:st,pathMatch:"prefix"}];let Tt=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({providers:[F],imports:[S.ez,M.L,s.Aw.forFeature("incident-reaffectes",ae),l.sQ.forFeature(ht),_t.Y,gt.h,It.B,Ct.K,St.m,E.Bz.forChild(xt)]})}return n})()}}]);