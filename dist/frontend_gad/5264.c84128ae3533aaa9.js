"use strict";(self.webpackChunkfrontend_gad=self.webpackChunkfrontend_gad||[]).push([[5264],{5264:(Kt,b,c)=>{c.r(b),c.d(b,{IncidentCoursResolutionModule:()=>Nt});var x=c(6814),Q=c(4970),Y=c(5779),z=c(3975),D=c(3096),q=c(2572),_=c(7398),n=c(676);const p="Incident En Cours de R\xe9solution IT",J=(0,n.PH)(`[${p} API] Load All`),V=(0,n.PH)(`[${p} API] Load All Success`,(0,n.Ky)()),W=(0,n.PH)(`[${p} API] Create`,(0,n.Ky)()),j=(0,n.PH)(`[${p} API] Create Success`,(0,n.Ky)()),X=(0,n.PH)(`[${p} API] Load`,(0,n.Ky)()),w=(0,n.PH)(`[${p} API] Reset`),k=(0,n.PH)(`[${p} API] Load Success`,(0,n.Ky)()),ee=(0,n.PH)(`[${p} API] Delete`,(0,n.Ky)()),te=(0,n.PH)(`[${p} API] Delete Success`,(0,n.Ky)()),ie=(0,n.PH)(`[${p} API] Validate`,(0,n.Ky)()),ne=(0,n.PH)(`[${p} API] Validate Success`,(0,n.Ky)()),se=(0,n.PH)(`[${p} API] Update`,(0,n.Ky)()),oe=(0,n.PH)(`[${p} API] Update Success`,(0,n.Ky)()),re=(0,n.PH)(`[${p} API] Load Form Model`),ce=(0,n.PH)(`[${p} API] Reset Form Model`),ae=(0,n.PH)(`[${p} API] Load Form Model Success`,(0,n.Ky)()),le=(0,n.PH)(`[${p} API] Reset Search`),de=(0,n.PH)(`[${p} API] Search`,(0,n.Ky)()),ue=(0,n.PH)(`[${p} API] Change Page`,(0,n.Ky)()),pe=(0,n.PH)(`[${p} API] Change Page Size`,(0,n.Ky)()),r={loadItems:J,loadItemsSuccess:V,resetItem:w,createItem:W,createItemSuccess:j,loadItem:X,loadItemSuccess:k,updateItem:se,updateItemSuccess:oe,deleteItem:ee,deleteItemSuccess:te,validateItem:ie,validateItemSuccess:ne,loadFormModel:re,resetFormModel:ce,loadFormModelSuccess:ae,setError:(0,n.PH)(`[${p} API] Create Error`,(0,n.Ky)()),resetError:(0,n.PH)(`[${p} API] Reset Error`),resetErrorField:(0,n.PH)(`[${p} API] Reset Error Field`,(0,n.Ky)()),resetSearch:le,search:de,changePage:ue,changePageSize:pe},ge=(0,n.Lq)({formModel:null,searchModel:{},items:[],currentItem:null,page:1,pageSize:15,totalElement:0,errors:null},(0,n.on)(r.loadItemsSuccess,(i,o)=>(console.log(o.items),{...i,items:o.items,totalElement:o.totalElement})),(0,n.on)(r.resetItem,(i,o)=>({...i,currentItem:null})),(0,n.on)(r.createItemSuccess,(i,o)=>({...i})),(0,n.on)(r.deleteItemSuccess,(i,o)=>({...i})),(0,n.on)(r.loadItemSuccess,(i,o)=>({...i,currentItem:o.item})),(0,n.on)(r.updateItemSuccess,(i,o)=>({...i})),(0,n.on)(r.validateItemSuccess,(i,o)=>({...i})),(0,n.on)(r.loadFormModel,(i,o)=>({...i,formModel:null})),(0,n.on)(r.loadFormModelSuccess,(i,o)=>({...i,formModel:o.formModel})),(0,n.on)(r.resetSearch,(i,o)=>({...i,searchModel:{}})),(0,n.on)(r.search,(i,o)=>({...i,searchModel:o.searchModel})),(0,n.on)(r.changePage,(i,o)=>({...i,page:o.page})),(0,n.on)(r.changePageSize,(i,o)=>({...i,pageSize:o.pageSize})),(0,n.on)(r.setError,(i,o)=>({...i,errors:o.errors})),(0,n.on)(r.resetError,(i,o)=>({...i,errors:{}})),(0,n.on)(r.resetErrorField,(i,o)=>{let t={};return null!==i.errors&&Object.entries(i.errors).forEach(([s,a])=>{s!==o.fieldName&&(t[`${s}`]=a)}),{...i,errors:t}})),E=(0,n.ZF)("incident-cours-resolutions"),Ce=(0,n.P1)(E,i=>i.items),Ie=(0,n.P1)(E,i=>i.currentItem),Se=(0,n.P1)(E,i=>i.formModel),Ee=(0,n.P1)(E,i=>i.searchModel),M=(0,n.P1)(E,i=>i.page),F=(0,n.P1)(E,i=>i.pageSize),ve=(0,n.P1)(E,i=>i.totalElement),xe=(0,n.P1)(E,i=>i.errors);var e=c(9468),R=c(8281),N=c(3849),$=c(95),Te=c(7251),ye=c(166),Pe=c(6327),Re=c(8564),Ae=c(8223),$e=c(602),Ze=c(1469),Le=c(6326),be=c(8346),De=c(1171),Me=c(547),U=c(362);function Fe(i,o){1&i&&(e.TgZ(0,"th",33),e._uU(1,"R\xe9f\xe9rence"),e.qZA())}const C=function(i){return{alert:i}};function Ne(i,o){if(1&i&&(e.TgZ(0,"td",34),e._uU(1),e.qZA()),2&i){const t=o.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(2,C,s.isDueDate(t.dateEcheanceResolution))),e.xp6(1),e.Oqu(t.refSys)}}function Ue(i,o){1&i&&(e.TgZ(0,"th",35),e._uU(1,"Libell\xe9 Demande"),e.qZA())}function Ke(i,o){if(1&i&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&i){const t=o.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(2,C,s.isDueDate(t.dateEcheanceResolution))),e.xp6(1),e.Oqu(t.titre)}}function Be(i,o){1&i&&(e.TgZ(0,"th",33),e._uU(1,"Equipement"),e.qZA())}function He(i,o){if(1&i&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&i){const t=o.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(2,C,s.isDueDate(t.dateEcheanceResolution))),e.xp6(1),e.Oqu(t.equipement.libelle)}}function Ge(i,o){1&i&&(e.TgZ(0,"th",33),e._uU(1,"Statut"),e.qZA())}function Oe(i,o){if(1&i&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&i){const t=o.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(2,C,s.isDueDate(t.dateEcheanceResolution))),e.xp6(1),e.Oqu(t.statutIncident)}}function Qe(i,o){1&i&&(e.TgZ(0,"th",33),e._uU(1,"Demandeur"),e.qZA())}function Ye(i,o){if(1&i&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&i){const t=o.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(3,C,s.isDueDate(t.dateEcheanceResolution))),e.xp6(1),e.AsE("",null==t.demandeur?null:t.demandeur.firstName," ",null==t.demandeur?null:t.demandeur.lastName,"")}}function ze(i,o){1&i&&(e.TgZ(0,"th",33),e._uU(1,"Priorit\xe9"),e.qZA())}function qe(i,o){if(1&i&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&i){const t=o.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(2,C,s.isDueDate(t.dateEcheanceResolution))),e.xp6(1),e.Oqu(t.prioriteIncident)}}function Je(i,o){1&i&&(e.TgZ(0,"th",33),e._uU(1,"S\xe9v\xe9rit\xe9"),e.qZA())}function Ve(i,o){if(1&i&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&i){const t=o.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(2,C,s.isDueDate(t.dateEcheanceResolution))),e.xp6(1),e.Oqu(null==t.severite?null:t.severite.libelle)}}function We(i,o){1&i&&(e.TgZ(0,"th",33),e._uU(1,"Date Cr\xe9ation"),e.qZA())}function je(i,o){if(1&i&&(e.TgZ(0,"td",36),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=o.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(5,C,s.isDueDate(t.dateEcheanceResolution))),e.xp6(1),e.Oqu(e.xi3(2,2,t.dateCreation,"dd/MM/y \xe0 HH:mm:ss"))}}function Xe(i,o){1&i&&(e.TgZ(0,"th",33),e._uU(1,"Date Affect"),e.qZA())}function we(i,o){if(1&i&&(e.TgZ(0,"td",36),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=o.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(5,C,s.isDueDate(t.dateEcheanceResolution))),e.xp6(1),e.Oqu(e.xi3(2,2,t.datePriseEnCharge,"dd/MM/y \xe0 HH:mm:ss"))}}function ke(i,o){1&i&&(e.TgZ(0,"th",33),e._uU(1,"Date Derni\xe8re Modif"),e.qZA())}function et(i,o){if(1&i&&(e.TgZ(0,"td",36),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=o.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(5,C,s.isDueDate(t.dateEcheanceResolution))),e.xp6(1),e.Oqu(e.xi3(2,2,t.dateDerniereModification,"dd/MM/y \xe0 HH:mm:ss"))}}function tt(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"table",18),e.NdJ("itemSelected",function(a){e.CHM(t);const h=e.oxw(2);return e.KtG(h.itemSelected(a))}),e.ynx(1,19),e.YNc(2,Fe,2,0,"th",20),e.YNc(3,Ne,2,4,"td",21),e.BQk(),e.ynx(4,22),e.YNc(5,Ue,2,0,"th",23),e.YNc(6,Ke,2,4,"td",24),e.BQk(),e.ynx(7,25),e.YNc(8,Be,2,0,"th",20),e.YNc(9,He,2,4,"td",24),e.BQk(),e.ynx(10,26),e.YNc(11,Ge,2,0,"th",20),e.YNc(12,Oe,2,4,"td",24),e.BQk(),e.ynx(13,27),e.YNc(14,Qe,2,0,"th",20),e.YNc(15,Ye,2,5,"td",24),e.BQk(),e.ynx(16,28),e.YNc(17,ze,2,0,"th",20),e.YNc(18,qe,2,4,"td",24),e.BQk(),e.ynx(19,29),e.YNc(20,Je,2,0,"th",20),e.YNc(21,Ve,2,4,"td",24),e.BQk(),e.ynx(22,30),e.YNc(23,We,2,0,"th",20),e.YNc(24,je,3,7,"td",24),e.BQk(),e.ynx(25,31),e.YNc(26,Xe,2,0,"th",20),e.YNc(27,we,3,7,"td",24),e.BQk(),e.ynx(28,32),e.YNc(29,ke,2,0,"th",20),e.YNc(30,et,3,7,"td",24),e.BQk(),e.qZA()}if(2&i){const t=o.ngIf,s=e.oxw(2);e.Q6J("items",t)("headers",s.headerTable)("selectable",!0)}}function it(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"app-crud-list",3),e.NdJ("searchButtonClicked",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.searchButtonClicked())})("refreshButtonClicked",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.refreshButtonClicked())})("pageSelected",function(a){e.CHM(t);const h=e.oxw();return e.KtG(h.pageSelected(a))})("pageSizeChange",function(a){e.CHM(t);const h=e.oxw();return e.KtG(h.pageSizeChange(a))})("closeButtonClicked",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.closeButtonClicked())}),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6),e._UZ(4,"app-form-label",7),e.qZA(),e.TgZ(5,"div",8),e._UZ(6,"app-custom-textfield",9),e.qZA()()(),e._UZ(7,"div",10),e.TgZ(8,"div",11)(9,"app-custom-button",12),e.NdJ("buttonClicked",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.validateButtonClicked())}),e.qZA()(),e.TgZ(10,"div",13),e._UZ(11,"app-custom-button",14),e.TgZ(12,"app-print-button",15),e.NdJ("printButtonClicked",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.printButtonClicked())}),e.qZA()(),e.TgZ(13,"div",16),e.YNc(14,tt,31,3,"table",17),e.ALo(15,"async"),e.qZA()()}if(2&i){const t=o.ngIf,s=e.oxw();e.Q6J("itemSelected",s.isItemSelected())("pageSize",t.pageSize)("currentPage",t.page)("totalElements",t.totalElement),e.xp6(1),e.Q6J("formGroup",s.searchForm),e.xp6(6),e.Q6J("formGroup",s.searchForm),e.xp6(2),e.Q6J("disabled",!s.isItemSelected()),e.xp6(5),e.Q6J("ngIf",e.lcZ(15,8,s.items$))}}let nt=(()=>{class i{constructor(t,s,a){this.router=t,this.store=s,this.incidentFormService=a,this.isUpdateActivated=!1,this.headerTable=["R\xe9f\xe9rence","Libell\xe9 Demande","Equipement","Statut","Priorit\xe9","S\xe9v\xe9rit\xe9","Impact","Demandeur","service/unit.Fonct","Date Cr\xe9ation","Date Affect","Date Dern modif"],this.items$=this.store.select(Ce),this.page$=this.store.select(M),this.pageSize$=this.store.select(F),this.totalElement$=this.store.select(ve),this.data$=(0,q.a)([this.page$,this.pageSize$,this.totalElement$]).pipe((0,_.U)(([h,I,S])=>({page:h,pageSize:I,totalElement:S}))),this.selectedItem=null,this.actualDate=0}ngOnInit(){this.searchForm=this.incidentFormService.createSearchForm(),this.store.dispatch(r.loadItems()),this.items$.subscribe(t=>{console.log(t)}),this.actualDate=Date.now()}validateButtonClicked(){const t=this.selectedItem?.id;t&&(this.store.dispatch(r.resetItem()),this.router.navigate(["incidents","resolution","validate",t]))}isDueDate(t){return console.log(t-this.actualDate<=0),t-this.actualDate<=0}itemSelected(t){this.selectedItem=t}pageSelected(t){this.store.dispatch(r.changePage({page:t}))}pageSizeChange(t){this.store.dispatch(r.changePageSize({pageSize:t}))}closeButtonClicked(){this.router.navigate(["incidents"])}isItemSelected(){return null!==this.selectedItem}refreshButtonClicked(){this.searchForm.reset(),this.store.dispatch(r.resetSearch())}searchButtonClicked(){this.store.dispatch(r.search({searchModel:this.searchForm.value}))}printButtonClicked(){}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(R.F0),e.Y36(n.yh),e.Y36(D.X))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-incident-cours-resolution-list"]],features:[e._Bn([D.X,z.x,Q.W,Y.P])],decls:4,vars:3,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Support IT","pathLevelTwo","En Cours de R\xe9solution","pathLevelThree","Liste"],["title","Liste des Incidents En Cours de R\xe9solution",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked",4,"ngIf"],["title","Liste des Incidents En Cours de R\xe9solution",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked"],[1,"normal-search",3,"formGroup"],[1,"d-flex","flex-row","align-items-center"],[1,"text-end","me-1","width-label-search"],["title","Libell\xe9"],[1,"input-textfield-container","col-3"],["placeholder","","otherclass","item-input","formControlName","titre"],[1,"advance-search",3,"formGroup"],[1,"primary-actions"],["icon","icon-check btn-icon-add fw-bold","title","R\xe9soudre",1,"me-1",3,"disabled","buttonClicked"],[1,"secondary-actions","d-flex"],["customClass","btn btn-sm button-action","title","Exporter","url","export.svg",1,"me-1","ms-1"],[3,"printButtonClicked"],[1,"table-content"],["appDynamicTable","",3,"items","headers","selectable","itemSelected",4,"ngIf"],["appDynamicTable","",3,"items","headers","selectable","itemSelected"],["appCellDef","R\xe9f\xe9rence"],["app-header-attribute-def-template","",4,"appHeaderDefTemplate"],["app-cell-def-template","",3,"ngClass",4,"appCellDefTemplate"],["appCellDef","Libell\xe9 Demande"],["app-header-attribute-def-template","","class","width-35",4,"appHeaderDefTemplate"],["app-cell-def-template","","class","left",3,"ngClass",4,"appCellDefTemplate"],["appCellDef","Equipement"],["appCellDef","Statut"],["appCellDef","Demandeur"],["appCellDef","Priorit\xe9"],["appCellDef","S\xe9v\xe9rit\xe9"],["appCellDef","Date Cr\xe9ation"],["appCellDef","Date Affect"],["appCellDef","Date Modification"],["app-header-attribute-def-template",""],["app-cell-def-template","",3,"ngClass"],["app-header-attribute-def-template","",1,"width-35"],["app-cell-def-template","",1,"left",3,"ngClass"]],template:function(s,a){1&s&&(e.TgZ(0,"div",0),e._UZ(1,"app-custom-breadcrumb",1),e.qZA(),e.YNc(2,it,16,10,"app-crud-list",2),e.ALo(3,"async")),2&s&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,a.data$)))},dependencies:[x.mk,x.O5,N.L,$.JJ,$.JL,$.sg,$.u,Te._,ye.x,Pe.N,Re.D,Ae.h,$e.u,Ze.O,Le.q,be.W,De.h,Me.Z,U.V,x.Ov,x.uU],styles:["[_nghost-%COMP%]{width:100%}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}.left[_ngcontent-%COMP%]{text-align:left!important}.alert[_ngcontent-%COMP%]{background-color:#f5c2c7!important}"]})}return i})();var st=c(4557),ot=c(7394),K=c(6366),rt=c(3936);function ct(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"app-incident-form",5),e.NdJ("formSubmitted",function(a){e.CHM(t);const h=e.oxw(2);return e.KtG(h.validateIncident(a))})("returnToList",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.returnToList())})("fieldReset",function(a){e.CHM(t);const h=e.oxw(2);return e.KtG(h.resetBackendError(a))}),e.qZA()}if(2&i){const t=e.oxw().ngIf,s=e.oxw();e.Q6J("incident",s.itemIncident)("formModel",t)("errors",s.error)("operationType",s.operationType)}}function at(i,o){if(1&i&&(e.ynx(0,3),e.YNc(1,ct,1,4,"app-incident-form",4),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.itemIncident)}}let lt=(()=>{class i{constructor(t,s,a,h,I){this.store=t,this.route=s,this.router=a,this.storeAuth=h,this.authService=I,this.formModel$=this.store.select(Se),this.incident$=this.store.select(Ie),this.itemIncident=null,this.errors$=this.store.select(xe),this.error={},this.operationType=st.C.BEING_RESOLVED,this.subscription=new ot.w0}ngOnInit(){this.store.dispatch(r.resetFormModel()),this.subscription=this.route.params.subscribe(t=>{this.id=t.id,this.id&&this.store.dispatch(r.loadItem({id:this.id}))}),this.store.dispatch(r.resetItem()),this.store.dispatch(r.loadFormModel()),this.errors$.subscribe(t=>{null!==t&&(this.error=t)}),this.incident$.subscribe(t=>{t&&(this.itemIncident={id:t.id,titre:t.titre,description:t.description,categorieIncident:t.categorieIncident,probleme:t.probleme,firstName:null==t.demandeur?"":t.demandeur.firstName,lastName:null==t.demandeur?"":t.demandeur.lastName,userName:null==t.demandeur?"":t.demandeur.userName,demandeur:t.demandeur,refSys:t.refSys,etapeIncident:t.statutIncident,firstNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.firstName,lastNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.lastName,userNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.userName,firstNameSupport:null==t.gestionnaire?"":t.gestionnaire.firstName,lastNameSupport:null==t.gestionnaire?"":t.gestionnaire.lastName,userNameSupport:null==t.gestionnaire?"":t.gestionnaire.userName,gestionnaire:t.gestionnaire,impact:t.impact,test:this.valueOfRadio(t.demandeur)?"moi-m\xeame":"autre que moi",equipement:t.equipement,groupeEquipement:null==t.equipement?"":t.equipement.modelEquip.categoryEquip.groupEquip.libelle,categorieEquipement:null==t.equipement?"":t.equipement.modelEquip.categoryEquip.libelle,sousCategorieEquipement:"",libelleEquipement:null==t.equipement?"":t.equipement.libelle,numeroSerie:null==t.equipement?"":t.equipement.numeroSerie,source:t.source,severite:t.severite,statutIncident:t.statutIncident,prioriteIncident:t.prioriteIncident,typeIncident:t.typeIncident,dateDerniereModification:null===t.dateDerniereModification?"":this.formatDate(t.dateDerniereModification),dateCreation:null===t.dateCreation?"":this.formatDate(t.dateCreation)})})}valueOfRadio(t){return null!==this.authService.getUserInfo()&&null!==t&&this.authService.getUserInfo().firstName===t.firstName&&this.authService.getUserInfo().lastName===t.lastName&&this.authService.getUserInfo().userName===t.userName}formatDate(t){if(t){const s=new Date(t);return s.toLocaleDateString()+" \xe0 "+s.toLocaleTimeString()}return null}ngOnDestroy(){this.subscription.unsubscribe()}validateIncident(t){const s=[];t.solution?.etapes.forEach(I=>{s.push({numeroEtape:I.numeroEtape,actionSuggere:{libelle:I.actionSuggere?.libelle,description:"",statut:null}})});const h={id:this.id,probleme:t.probleme,source:t.source,severite:t.severite,equipement:t.equipement,typeIncident:t.typeIncident,prioriteIncident:t.prioriteIncident,demandeur:t.demandeur,gestionnaire:t.gestionnaire,titre:t.titre,impact:t.impact,description:t.description,solution:{id:"",libelle:t.solution?.libelle,code:t.solution?.code,refSys:"",description:t.solution?.description,nombreEtape:t.solution?.nombreEtape,etapes:s}};console.log(h),this.store.dispatch(r.validateItem({id:Number(this.id),item:h}))}resetBackendError(t){console.log(t),this.store.dispatch(r.resetErrorField({fieldName:t}))}returnToList(){this.router.navigateByUrl("incidents/resolution")}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(n.yh),e.Y36(R.gz),e.Y36(R.F0),e.Y36(n.yh),e.Y36(K.e))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-incident-cours-resolution-validate"]],decls:4,vars:3,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Support IT","pathLevelTwo","En Cours de R\xe9solution","pathLevelThree","Marquer Comme R\xe9solu"],["class","mt-0 pt-0",4,"ngIf"],[1,"mt-0","pt-0"],["actionTitle","Enregistrer",3,"incident","formModel","errors","operationType","formSubmitted","returnToList","fieldReset",4,"ngIf"],["actionTitle","Enregistrer",3,"incident","formModel","errors","operationType","formSubmitted","returnToList","fieldReset"]],template:function(s,a){1&s&&(e.TgZ(0,"div",0),e._UZ(1,"app-custom-breadcrumb",1),e.qZA(),e.YNc(2,at,2,1,"ng-container",2),e.ALo(3,"async")),2&s&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,a.formModel$)))},dependencies:[x.O5,rt.u,U.V,x.Ov],styles:["[_nghost-%COMP%]{width:100%}"]})}return i})(),dt=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-incident-cours-resolution-reject"]],decls:2,vars:0,template:function(s,a){1&s&&(e.TgZ(0,"p"),e._uU(1,"incident-cours-resolution-reject works!"),e.qZA())}})}return i})();var ut=c(8510),d=c(6465),pt=c(9207),mt=c(1793),ht=c(3396),ft=c(2030),_t=c(9989),gt=c(1946);let B=(()=>{class i extends _t.v{getResourceBasePath(){return`${gt.y}/Support-incident-en-cours-resolution`}getIdValue(t){return t.id}validate(t,s){return this.http.post(`${this.url}/${this.getResourceBasePath()}/resolu/${t}`,s)}static#e=this.\u0275fac=function(){let t;return function(a){return(t||(t=e.n5z(i)))(a||i)}}();static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac})}return i})();var m=c(6063),Ct=c(2460),g=c(6328),It=c(9026),v=c(6306),A=c(9397),St=c(1631),H=c(9862),f=c(2096),Et=c(3186),vt=c(4664),G=c(797);let xt=(()=>{class i{constructor(t,s,a,h,I,S){this.incidentCoursResolutionService=t,this.authService=s,this.actions$=a,this.router=h,this.modalService=I,this.store=S,this.loadItems$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.loadItems),(0,Ct.M)(this.store.select(M),this.store.select(F),this.store.select(Ee)),(0,g.b)(([l,u,Z,L])=>(console.log(l.type),this.store.dispatch((0,m.Q)()),(0,It.$)(this.incidentCoursResolutionService.getAllWithPagination(u,Z,L),this.incidentCoursResolutionService.count(L)).pipe((0,_.U)(([P,Ut])=>(console.log(P),this.store.dispatch((0,m.Z)()),r.loadItemsSuccess({items:P,totalElement:Ut}))),(0,v.K)(P=>(this.store.dispatch((0,m.Z)()),(0,f.of)(r.setError({errors:P})))))))),{dispatch:!0}),this.createItem$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.createItem),(0,g.b)(l=>(this.store.dispatch((0,m.Q)()),console.log(l.item),this.incidentCoursResolutionService.add(l.item).pipe((0,A.b)(()=>{this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident ajout\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/resolution")}),(0,_.U)(u=>r.createItemSuccess({item:u})),(0,v.K)(u=>(this.store.dispatch((0,m.Z)()),(0,f.of)(r.setError({errors:u})))))))),{dispatch:!0}),this.loadItem$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.loadItem),(0,St.z)(l=>this.incidentCoursResolutionService.findById(l.id).pipe((0,_.U)(u=>r.loadItemSuccess({item:u})),(0,v.K)(u=>(this.store.dispatch((0,m.Z)()),(0,f.of)(r.setError({errors:u}))))))),{dispatch:!0}),this.deleteItem$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.deleteItem),(0,g.b)(l=>this.incidentCoursResolutionService.delete(l.item.id,l.item)),(0,A.b)(()=>{this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident supprim\xe9 avec succ\xe8s"})}),(0,_.U)(()=>r.loadItems()),(0,v.K)(l=>(this.store.dispatch((0,m.Z)()),(0,f.of)(r.setError({errors:l}))))),{dispatch:!0}),this.updateItem$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.updateItem),(0,g.b)(l=>(this.store.dispatch((0,m.Q)()),this.incidentCoursResolutionService.update(l.item.id,l.item).pipe((0,A.b)(()=>{this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident modifi\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/resolution")}),(0,_.U)(u=>r.createItemSuccess({item:u})),(0,v.K)(u=>(this.store.dispatch((0,m.Z)()),(0,f.of)(r.setError({errors:u})))))))),{dispatch:!0}),this.validateItem$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.validateItem),(0,g.b)(l=>(this.store.dispatch((0,m.Q)()),this.incidentCoursResolutionService.validate(l.id,l.item).pipe((0,A.b)(()=>{this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident Affect\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/resolution")}),(0,_.U)(u=>r.validateItemSuccess({item:u})),(0,v.K)(u=>(this.store.dispatch((0,m.Z)()),(0,f.of)(r.setError({errors:u})))))))),{dispatch:!0}),this.loadFormModel$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.loadFormModel),(0,g.b)(()=>this.incidentCoursResolutionService.getFormModel()),(0,_.U)(l=>r.loadFormModelSuccess({formModel:l})),(0,v.K)(l=>(0,f.of)(r.setError({errors:l}))))),this.resetSearch$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.resetSearch),(0,g.b)(()=>(0,f.of)(r.changePage({page:1}))))),this.search$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.search),(0,g.b)(()=>(0,f.of)(r.changePage({page:1}))))),this.changePage$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.changePage),(0,_.U)(l=>r.loadItems()))),this.changePageSize$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.changePageSize),(0,g.b)(()=>(0,f.of)(r.changePage({page:1}))))),this.handleError$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.setError),(0,vt.w)(l=>{if(this.store.dispatch((0,m.Q)()),l.errors instanceof H.UA){if(422===l.errors.status){let u="",Z=0;for(const[L,P]of Object.entries(l.errors.error))u+=0===Z?P:"\n"+P,Z++;this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:u})}if(403===l.errors.status&&this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:"Vous n'avez pas le droit requis pour effectuer cette action"}),401===l.errors.status){let u="Votre token a expir\xe9, veuillez vous reconnecter svp!";return this.authService.removeToken(),this.authService.removeUserInfo(),this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:u}),(0,f.of)(Et.jM())}}return this.store.dispatch((0,m.Z)()),(0,f.of)({type:"noop"})})),{dispatch:!0})}static#e=this.\u0275fac=function(s){return new(s||i)(e.LFG(B),e.LFG(K.e),e.LFG(d.eX),e.LFG(R.F0),e.LFG(G.Z),e.LFG(n.yh))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac})}return i})();const T="Commentaire",y={loadItems:(0,n.PH)(`[${T} API] Load All`,(0,n.Ky)()),loadItemsSuccess:(0,n.PH)(`[${T} API] Load All Success`,(0,n.Ky)()),createItem:(0,n.PH)(`[${T} API] Create`,(0,n.Ky)()),createItemSuccess:(0,n.PH)(`[${T} API] Create Success`,(0,n.Ky)()),setError:(0,n.PH)(`[${T} API] Create Error`,(0,n.Ky)()),resetError:(0,n.PH)(`[${T} API] Reset Error`),resetErrorField:(0,n.PH)(`[${T} API] Reset Error Field`,(0,n.Ky)())},bt=(0,n.Lq)({items:[],currentItem:null,errors:null},(0,n.on)(y.loadItemsSuccess,(i,o)=>(console.log(o.items),{...i,items:o.items})),(0,n.on)(y.createItemSuccess,(i,o)=>({...i})),(0,n.on)(r.setError,(i,o)=>({...i,errors:o.errors})),(0,n.on)(r.resetError,(i,o)=>({...i,errors:{}})),(0,n.on)(r.resetErrorField,(i,o)=>{let t={};return null!==i.errors&&Object.entries(i.errors).forEach(([s,a])=>{s!==o.fieldName&&(t[`${s}`]=a)}),{...i,errors:t}}));(0,n.ZF)("commentaires");var Dt=c(8504),O=c(2018);let Mt=(()=>{class i{constructor(t,s,a,h,I){this.commentaireService=t,this.actions$=s,this.router=a,this.modalService=h,this.store=I,this.loadItems$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(y.loadItems),(0,g.b)(S=>(this.store.dispatch((0,m.Q)()),this.commentaireService.getAllComment(S.id).pipe((0,_.U)(l=>(console.log(l),this.store.dispatch((0,m.Z)()),y.loadItemsSuccess({items:l}))))))),{dispatch:!0}),this.createItem$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(y.createItem),(0,g.b)(S=>(this.store.dispatch((0,m.Q)()),this.commentaireService.addComment(S.item,S.id).pipe((0,A.b)(()=>{this.store.dispatch((0,m.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Commentaire ajout\xe9 avec succ\xe8s"})}),(0,_.U)(l=>y.createItemSuccess({item:l})),(0,v.K)(l=>l instanceof H.UA&&422===l.status?(this.store.dispatch((0,m.Z)()),(0,f.of)(y.setError({errors:l.error}))):(this.store.dispatch((0,m.Z)()),(0,Dt._)(()=>l))))))),{dispatch:!0})}static#e=this.\u0275fac=function(s){return new(s||i)(e.LFG(O.k),e.LFG(d.eX),e.LFG(R.F0),e.LFG(G.Z),e.LFG(n.yh))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac})}return i})();const Ft=[{path:"",component:nt,pathMatch:"prefix"},{path:"validate/:id",component:lt,pathMatch:"prefix"},{path:"reject/:id",component:dt,pathMatch:"prefix"}];let Nt=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({providers:[B,O.k],imports:[x.ez,N.L,n.Aw.forFeature("incident-cours-resolutions",ge),n.Aw.forFeature("commentaires",bt),d.sQ.forFeature(xt),d.sQ.forFeature(Mt),ut.Y,ft.h,ht.B,mt.K,pt.m,R.Bz.forChild(Ft)]})}return i})()}}]);