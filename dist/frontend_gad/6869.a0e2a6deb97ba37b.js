"use strict";(self.webpackChunkfrontend_gad=self.webpackChunkfrontend_gad||[]).push([[6869],{6869:(ee,M,s)=>{s.r(M),s.d(M,{NouvelIncidentModule:()=>Tt});var _=s(6814),D=s(4970),O=s(5779),B=s(3975),h=s(3096),F=s(2572),I=s(7398),r=s(676);const u="Nouvel Incident Superviseur",y=(0,r.PH)(`[${u} API] Load All`),N=(0,r.PH)(`[${u} API] Load All Success`,(0,r.Ky)()),P=(0,r.PH)(`[${u} API] Create`,(0,r.Ky)()),U=(0,r.PH)(`[${u} API] Create Success`,(0,r.Ky)()),te=(0,r.PH)(`[${u} API] Load`,(0,r.Ky)()),ne=(0,r.PH)(`[${u} API] Reset`),ie=(0,r.PH)(`[${u} API] Load Success`,(0,r.Ky)()),re=(0,r.PH)(`[${u} API] Delete`,(0,r.Ky)()),oe=(0,r.PH)(`[${u} API] Delete Success`,(0,r.Ky)()),se=(0,r.PH)(`[${u} API] Affect`,(0,r.Ky)()),ce=(0,r.PH)(`[${u} API] Affect Success`,(0,r.Ky)()),ae=(0,r.PH)(`[${u} API] Update`,(0,r.Ky)()),de=(0,r.PH)(`[${u} API] Update Success`,(0,r.Ky)()),le=(0,r.PH)(`[${u} API] Load Form Model`),pe=(0,r.PH)(`[${u} API] Reset Form Model`),me=(0,r.PH)(`[${u} API] Load Form Model Success`,(0,r.Ky)()),ue=(0,r.PH)(`[${u} API] Reset Search`),he=(0,r.PH)(`[${u} API] Search`,(0,r.Ky)()),fe=(0,r.PH)(`[${u} API] Change Page`,(0,r.Ky)()),_e=(0,r.PH)(`[${u} API] Change Page Size`,(0,r.Ky)()),o={loadItems:y,loadItemsSuccess:N,resetItem:ne,createItem:P,createItemSuccess:U,loadItem:te,loadItemSuccess:ie,updateItem:ae,updateItemSuccess:de,deleteItem:re,deleteItemSuccess:oe,affectItem:se,affectItemSuccess:ce,loadFormModel:le,resetFormModel:pe,loadFormModelSuccess:me,setError:(0,r.PH)(`[${u} API] Create Error`,(0,r.Ky)()),resetError:(0,r.PH)(`[${u} API] Reset Error`),resetErrorField:(0,r.PH)(`[${u} API] Reset Error Field`,(0,r.Ky)()),resetSearch:ue,search:he,changePage:fe,changePageSize:_e},xe=(0,r.Lq)({formModel:null,searchModel:{},items:[],currentItem:null,page:1,pageSize:15,totalElement:0,errors:null},(0,r.on)(o.loadItemsSuccess,(n,a)=>({...n,items:a.items,totalElement:a.totalElement})),(0,r.on)(o.resetItem,(n,a)=>({...n,currentItem:null})),(0,r.on)(o.createItemSuccess,(n,a)=>({...n})),(0,r.on)(o.deleteItemSuccess,(n,a)=>({...n})),(0,r.on)(o.loadItemSuccess,(n,a)=>({...n,currentItem:a.item})),(0,r.on)(o.updateItemSuccess,(n,a)=>({...n})),(0,r.on)(o.affectItemSuccess,(n,a)=>({...n})),(0,r.on)(o.loadFormModel,(n,a)=>({...n,formModel:null})),(0,r.on)(o.loadFormModelSuccess,(n,a)=>({...n,formModel:a.formModel})),(0,r.on)(o.resetSearch,(n,a)=>({...n,searchModel:{}})),(0,r.on)(o.search,(n,a)=>({...n,searchModel:a.searchModel})),(0,r.on)(o.changePage,(n,a)=>({...n,page:a.page})),(0,r.on)(o.changePageSize,(n,a)=>({...n,pageSize:a.pageSize})),(0,r.on)(o.setError,(n,a)=>({...n,errors:a.errors})),(0,r.on)(o.resetError,(n,a)=>({...n,errors:{}})),(0,r.on)(o.resetErrorField,(n,a)=>{let t={};return null!==n.errors&&Object.entries(n.errors).forEach(([i,c])=>{i!==a.fieldName&&(t[`${i}`]=c)}),{...n,errors:t}})),S=(0,r.ZF)("nouvel-incidents"),Ne=(0,r.P1)(S,n=>n.items),z=(0,r.P1)(S,n=>n.currentItem),K=(0,r.P1)(S,n=>n.formModel),ve=(0,r.P1)(S,n=>n.searchModel),J=(0,r.P1)(S,n=>n.page),Q=(0,r.P1)(S,n=>n.pageSize),be=(0,r.P1)(S,n=>n.totalElement),q=(0,r.P1)(S,n=>n.errors);var Te=s(4849),e=s(9468),x=s(8281),k=s(797),w=s(3849),A=s(95),Ee=s(7251),ye=s(166),Me=s(6327),Pe=s(8564),Ae=s(8223),Ze=s(602),Le=s(1469),$e=s(6326),De=s(8346),Oe=s(1171),Be=s(547),Z=s(362);function Fe(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1,"R\xe9f\xe9rence"),e.qZA())}const v=function(n){return{alert:n}};function Ue(n,a){if(1&n&&(e.TgZ(0,"td",34),e._uU(1),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(2,v,i.isDueDate(t.dateEcheancePriseEnCharge))),e.xp6(1),e.hij("",t.refSys," ")}}function Ke(n,a){1&n&&(e.TgZ(0,"th",35),e._uU(1,"Libell\xe9 Demande"),e.qZA())}function qe(n,a){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(2,v,i.isDueDate(t.dateEcheancePriseEnCharge))),e.xp6(1),e.hij("",t.titre," ")}}function Ge(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Equipement"),e.qZA())}function He(n,a){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(2,v,i.isDueDate(t.dateEcheancePriseEnCharge))),e.xp6(1),e.Oqu(t.equipement.libelle)}}function Re(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Statut"),e.qZA())}function Ye(n,a){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(2,v,i.isDueDate(t.dateEcheancePriseEnCharge))),e.xp6(1),e.Oqu(t.statutIncident)}}function ze(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Emis Par"),e.qZA())}function Je(n,a){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(3,v,i.isDueDate(t.dateEcheancePriseEnCharge))),e.xp6(1),e.AsE("",t.demandeur.firstName," ",t.demandeur.lastName,"")}}function Qe(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Date Cr\xe9ation"),e.qZA())}function ke(n,a){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(5,v,i.isDueDate(t.dateEcheancePriseEnCharge))),e.xp6(1),e.hij("",e.xi3(2,2,t.dateDeclaration,"dd/MM/y \xe0 HH:mm:ss")," ")}}function we(n,a){1&n&&(e.TgZ(0,"th",33),e._uU(1,"Date Derni\xe8re Modif"),e.qZA())}function je(n,a){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(5,v,i.isDueDate(t.dateEcheancePriseEnCharge))),e.xp6(1),e.hij("",e.xi3(2,2,t.dateDerniereModification,"dd/MM/y \xe0 HH:mm:ss")," ")}}function We(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"table",21),e.NdJ("itemSelected",function(c){e.CHM(t);const m=e.oxw(2);return e.KtG(m.itemSelected(c))}),e.ynx(1,22),e.YNc(2,Fe,2,0,"th",23),e.YNc(3,Ue,2,4,"td",24),e.BQk(),e.ynx(4,25),e.YNc(5,Ke,2,0,"th",26),e.YNc(6,qe,2,4,"td",27),e.BQk(),e.ynx(7,28),e.YNc(8,Ge,2,0,"th",23),e.YNc(9,He,2,4,"td",27),e.BQk(),e.ynx(10,29),e.YNc(11,Re,2,0,"th",23),e.YNc(12,Ye,2,4,"td",27),e.BQk(),e.ynx(13,30),e.YNc(14,ze,2,0,"th",23),e.YNc(15,Je,2,5,"td",27),e.BQk(),e.ynx(16,31),e.YNc(17,Qe,2,0,"th",23),e.YNc(18,ke,3,7,"td",27),e.BQk(),e.ynx(19,32),e.YNc(20,we,2,0,"th",23),e.YNc(21,je,3,7,"td",27),e.BQk(),e.qZA()}if(2&n){const t=a.ngIf,i=e.oxw(2);e.Q6J("items",t)("headers",i.headerTable)("selectable",!0)}}function Ve(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-crud-list",3),e.NdJ("searchButtonClicked",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.searchButtonClicked())})("refreshButtonClicked",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.refreshButtonClicked())})("pageSelected",function(c){e.CHM(t);const m=e.oxw();return e.KtG(m.pageSelected(c))})("pageSizeChange",function(c){e.CHM(t);const m=e.oxw();return e.KtG(m.pageSizeChange(c))})("closeButtonClicked",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.closeButtonClicked())}),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6),e._UZ(4,"app-form-label",7),e.qZA(),e.TgZ(5,"div",8),e._UZ(6,"app-custom-textfield",9),e.qZA()()(),e._UZ(7,"div",10),e.TgZ(8,"div",11)(9,"app-custom-button",12),e.NdJ("buttonClicked",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.addButtonClicked())}),e.qZA(),e.TgZ(10,"app-custom-button",13),e.NdJ("buttonClicked",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.editButtonClicked())}),e.qZA(),e.TgZ(11,"app-custom-button",14),e.NdJ("buttonClicked",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.deleteButtonClicked())}),e.qZA(),e.TgZ(12,"app-custom-button",15),e.NdJ("buttonClicked",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.affectButtonClicked())}),e.qZA()(),e.TgZ(13,"div",16),e._UZ(14,"app-custom-button",17),e.TgZ(15,"app-print-button",18),e.NdJ("printButtonClicked",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.printButtonClicked())}),e.qZA()(),e.TgZ(16,"div",19),e.YNc(17,We,22,3,"table",20),e.ALo(18,"async"),e.qZA()()}if(2&n){const t=a.ngIf,i=e.oxw();e.Q6J("itemSelected",i.isItemSelected())("pageSize",t.pageSize)("currentPage",t.page)("totalElements",t.totalElement),e.xp6(1),e.Q6J("formGroup",i.searchForm),e.xp6(6),e.Q6J("formGroup",i.searchForm),e.xp6(3),e.Q6J("disabled",!i.isItemSelected()),e.xp6(1),e.Q6J("disabled",!i.isItemSelected()),e.xp6(1),e.Q6J("disabled",!i.isItemSelected()),e.xp6(5),e.Q6J("ngIf",e.lcZ(18,10,i.items$))}}let Xe=(()=>{class n{constructor(t,i,c,m){this.router=t,this.modalService=i,this.store=c,this.incidentFormService=m,this.isUpdateActivated=!1,this.headerTable=["R\xe9f\xe9rence","Libell\xe9 Demande","Equipement","Statut","Priorit\xe9","S\xe9v\xe9rit\xe9","Impact","Demandeur","service/unit.Fonct","Date Cr\xe9ation","Date Dern modif"],this.items$=this.store.select(Ne),this.page$=this.store.select(J),this.pageSize$=this.store.select(Q),this.totalElement$=this.store.select(be),this.data$=(0,F.a)([this.page$,this.pageSize$,this.totalElement$]).pipe((0,I.U)(([T,R,d])=>({page:T,pageSize:R,totalElement:d}))),this.selectedItem=null,this.actualDate=0}ngOnInit(){this.searchForm=this.incidentFormService.createSearchForm(),this.store.dispatch(o.loadItems()),this.items$.subscribe(t=>{t&&console.log(t)}),this.actualDate=Date.now()}isDueDate(t){return t-this.actualDate<=0}addButtonClicked(){this.router.navigate(["incidents","incident","add"])}editButtonClicked(){const t=this.selectedItem?.id;t&&(this.store.dispatch(o.resetItem()),this.router.navigate(["incidents","incident","edit",t]))}affectButtonClicked(){const t=this.selectedItem?.id;t&&(this.store.dispatch(o.resetItem()),this.router.navigate(["incidents","incident","affect",t]))}rejectButtonClicked(){const t=this.selectedItem?.id;t&&(this.store.dispatch(o.resetItem()),this.router.navigate(["incidents","incident","reject",t]))}deleteButtonClicked(){const t=this.selectedItem;t&&this.modalService.openComponent(Te.n,{size:"md",otherclass:"custom-modal-height"}).afterClosed.subscribe(i=>{i&&"yes"===i&&this.store.dispatch(o.deleteItem({item:t}))})}itemSelected(t){this.selectedItem=t}pageSelected(t){this.store.dispatch(o.changePage({page:t}))}pageSizeChange(t){this.store.dispatch(o.changePageSize({pageSize:t}))}closeButtonClicked(){this.router.navigate(["incidents"])}isItemSelected(){return null!==this.selectedItem}refreshButtonClicked(){this.searchForm.reset(),this.store.dispatch(o.resetSearch())}searchButtonClicked(){this.store.dispatch(o.search({searchModel:this.searchForm.value}))}printButtonClicked(){}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.F0),e.Y36(k.Z),e.Y36(r.yh),e.Y36(h.X))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-nouvel-incident-list"]],features:[e._Bn([h.X,B.x,D.W,O.P])],decls:4,vars:3,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Supervision Incident","pathLevelTwo","Nouvel Incident","pathLevelThree","Liste"],["title","Liste des Nouveaux Incidents",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked",4,"ngIf"],["title","Liste des Nouveaux Incidents",3,"itemSelected","pageSize","currentPage","totalElements","searchButtonClicked","refreshButtonClicked","pageSelected","pageSizeChange","closeButtonClicked"],[1,"normal-search",3,"formGroup"],[1,"d-flex","flex-row","align-items-center"],[1,"text-end","me-1","width-label-search"],["title","Libell\xe9"],[1,"input-textfield-container","col-3"],["placeholder","","otherclass","item-input","formControlName","titre"],[1,"advance-search",3,"formGroup"],[1,"primary-actions"],["icon","icon-plus btn-icon-add fw-bold","title","Nouvel Incident",1,"me-1",3,"buttonClicked"],["icon","icon-edit-alt btn-icon-edit","title","Modifier",1,"me-1",3,"disabled","buttonClicked"],["icon","icon-trash btn-icon-delete","title","Supprimer",1,"me-1",3,"disabled","buttonClicked"],["icon","icon-check btn-icon-add","title","Affecter",1,"me-1",3,"disabled","buttonClicked"],[1,"secondary-actions","d-flex"],["customClass","btn btn-sm button-action","title","Exporter","url","export.svg",1,"me-1","ms-1"],[3,"printButtonClicked"],[1,"table-content"],["appDynamicTable","",3,"items","headers","selectable","itemSelected",4,"ngIf"],["appDynamicTable","",3,"items","headers","selectable","itemSelected"],["appCellDef","R\xe9f\xe9rence"],["app-header-attribute-def-template","",4,"appHeaderDefTemplate"],["app-cell-def-template","","class","text-start",3,"ngClass",4,"appCellDefTemplate"],["appCellDef","Libell\xe9 Demande"],["app-header-attribute-def-template","","class","width-35",4,"appHeaderDefTemplate"],["app-cell-def-template","","class","left",3,"ngClass",4,"appCellDefTemplate"],["appCellDef","Equipement"],["appCellDef","Statut"],["appCellDef","Demandeur"],["appCellDef","Date Cr\xe9ation"],["appCellDef","Date Modification"],["app-header-attribute-def-template",""],["app-cell-def-template","",1,"text-start",3,"ngClass"],["app-header-attribute-def-template","",1,"width-35"],["app-cell-def-template","",1,"left",3,"ngClass"]],template:function(i,c){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"app-custom-breadcrumb",1),e.qZA(),e.YNc(2,Ve,19,12,"app-crud-list",2),e.ALo(3,"async")),2&i&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,c.data$)))},dependencies:[_.mk,_.O5,w.L,A.JJ,A.JL,A.sg,A.u,Ee._,ye.x,Me.N,Pe.D,Ae.h,Ze.u,Le.O,$e.q,De.W,Oe.h,Be.Z,Z.V,_.Ov,_.uU],styles:["[_nghost-%COMP%]{width:100%}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}.left[_ngcontent-%COMP%]{text-align:left!important}.alert[_ngcontent-%COMP%]{background-color:#f5c2c7!important;border-radius:0!important}"]})}return n})();var j=s(4557),W=s(5002),G=s(3936);function et(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-incident-form",3),e.NdJ("formSubmitted",function(c){e.CHM(t);const m=e.oxw();return e.KtG(m.addIncident(c))})("fieldReset",function(c){e.CHM(t);const m=e.oxw();return e.KtG(m.resetBackendError(c))})("returnToList",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.returnToList())}),e.qZA(),e.BQk()}if(2&n){const t=a.ngIf,i=e.oxw();e.xp6(1),e.Q6J("incident",i.incident)("formModel",t)("errors",i.error)("operationType",i.operationType)("roleIncident",i.roleIncident)}}let tt=(()=>{class n{constructor(t,i){this.store=t,this.router=i,this.formModel$=this.store.select(K),this.errors$=this.store.select(q),this.error={},this.operationType=j.C.ADD,this.roleIncident=W.s.SUPERVISOR,this.incident={id:"",titre:"",description:"",categorieIncident:null,probleme:null,refSys:"",etapeIncident:"D\xe9clar\xe9",firstName:"",lastName:"",userName:"",demandeur:null,firstNameGestionnaire:"",lastNameGestionnaire:"",userNameGestionnaire:"",firstNameSupport:"",lastNameSupport:"",userNameSupport:"",gestionnaire:null,impact:null,equipement:null,numeroSerie:"",libelleEquipement:"",sousCategorieEquipement:"",categorieEquipement:"",groupeEquipement:"",test:"moi-m\xeame",source:null,severite:null,statutIncident:"D\xe9clar\xe9",prioriteIncident:"Basse",typeIncident:"MATERIEL",dateCreation:null,dateDerniereModification:null}}ngOnInit(){this.store.dispatch(o.resetItem()),this.store.dispatch(o.resetFormModel()),this.store.dispatch(o.loadFormModel()),this.errors$.subscribe(t=>{null!==t&&(this.error=t)})}addIncident(t){const i={titre:t.titre,description:t.description,equipement:t.equipement,typeIncident:t.typeIncident,demandeur:t.demandeur};console.log(i),this.store.dispatch(o.createItem({item:i}))}resetBackendError(t){this.store.dispatch(o.resetErrorField({fieldName:t}))}returnToList(){this.router.navigateByUrl("incidents/incident")}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.yh),e.Y36(x.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-nouvel-incident-add"]],decls:4,vars:3,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Supervision Incident","pathLevelTwo","Nouvel Incident","pathLevelThree","Ajouter"],[4,"ngIf"],[3,"incident","formModel","errors","operationType","roleIncident","formSubmitted","fieldReset","returnToList"]],template:function(i,c){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"app-custom-breadcrumb",1),e.qZA(),e.YNc(2,et,2,5,"ng-container",2),e.ALo(3,"async")),2&i&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,c.formModel$)))},dependencies:[_.O5,G.u,Z.V,_.Ov],styles:["[_nghost-%COMP%]{width:100%}"]})}return n})();var V=s(7394),H=s(6366);function nt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-incident-form",4),e.NdJ("formSubmitted",function(c){e.CHM(t);const m=e.oxw(2);return e.KtG(m.editIncident(c))})("returnToList",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.returnToList())})("fieldReset",function(c){e.CHM(t);const m=e.oxw(2);return e.KtG(m.resetBackendError(c))}),e.qZA()}if(2&n){const t=e.oxw().ngIf,i=e.oxw();e.Q6J("incident",i.itemIncident)("formModel",t)("errors",i.error)}}function it(n,a){if(1&n&&(e.ynx(0),e.YNc(1,nt,1,3,"app-incident-form",3),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.itemIncident)}}let rt=(()=>{class n{constructor(t,i,c,m,T){this.store=t,this.route=i,this.router=c,this.storeAuth=m,this.authService=T,this.formModel$=this.store.select(K),this.incident$=this.store.select(z),this.itemIncident=null,this.errors$=this.store.select(q),this.error={},this.subscription=new V.w0}ngOnInit(){this.store.dispatch(o.resetFormModel()),this.subscription=this.route.params.subscribe(t=>{this.id=t.id,this.id&&this.store.dispatch(o.loadItem({id:this.id}))}),this.store.dispatch(o.resetItem()),this.store.dispatch(o.loadFormModel()),this.errors$.subscribe(t=>{null!==t&&(this.error=t)}),this.incident$.subscribe(t=>{t&&(this.itemIncident={id:t.id,titre:t.titre,description:t.description,categorieIncident:t.categorieIncident,probleme:t.probleme,refSys:t.refSys,etapeIncident:t.statutIncident,firstName:null==t.demandeur?"":t.demandeur.firstName,lastName:null==t.demandeur?"":t.demandeur.lastName,userName:null==t.demandeur?"":t.demandeur.userName,demandeur:t.demandeur,firstNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.firstName,lastNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.lastName,userNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.userName,firstNameSupport:null==t.gestionnaire?"":t.gestionnaire.firstName,lastNameSupport:null==t.gestionnaire?"":t.gestionnaire.lastName,userNameSupport:null==t.gestionnaire?"":t.gestionnaire.userName,gestionnaire:t.gestionnaire,impact:t.impact,test:this.valueOfRadio(t.demandeur)?"moi-m\xeame":"autre que moi",equipement:t.equipement,groupeEquipement:null==t.equipement?"":t.equipement.modelEquip.categoryEquip.groupEquip.libelle,categorieEquipement:null==t.equipement?"":t.equipement.modelEquip.categoryEquip.libelle,sousCategorieEquipement:"",libelleEquipement:null==t.equipement?"":t.equipement.libelle,numeroSerie:null==t.equipement?"":t.equipement.numeroSerie,source:t.source,severite:t.severite,statutIncident:t.statutIncident,prioriteIncident:t.prioriteIncident,typeIncident:t.typeIncident,dateDerniereModification:null===t.dateDerniereModification?"":this.formatDate(t.dateDerniereModification),dateCreation:null===t.dateCreation?"":this.formatDate(t.dateCreation)})})}valueOfRadio(t){return null!==this.authService.getUserInfo()&&null!==t&&this.authService.getUserInfo().firstName===t.firstName&&this.authService.getUserInfo().lastName===t.lastName&&this.authService.getUserInfo().userName===t.userName}formatDate(t){if(t){const i=new Date(t);return i.toLocaleDateString()+" \xe0 "+i.toLocaleTimeString()}return null}ngOnDestroy(){this.subscription.unsubscribe()}editIncident(t){const i={id:t.id,titre:t.titre,description:t.description,equipement:t.equipement,typeIncident:t.typeIncident,demandeur:t.demandeur};this.store.dispatch(o.updateItem({id:Number(this.id),item:i}))}resetBackendError(t){this.store.dispatch(o.resetErrorField({fieldName:t}))}returnToList(){this.router.navigateByUrl("incidents/incident")}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.yh),e.Y36(x.gz),e.Y36(x.F0),e.Y36(r.yh),e.Y36(H.e))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-nouvel-incident-edit"]],decls:4,vars:3,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Supervision Incident","pathLevelTwo","Nouvel Incident","pathLevelThree","Editer"],[4,"ngIf"],[3,"incident","formModel","errors","formSubmitted","returnToList","fieldReset",4,"ngIf"],[3,"incident","formModel","errors","formSubmitted","returnToList","fieldReset"]],template:function(i,c){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"app-custom-breadcrumb",1),e.qZA(),e.YNc(2,it,2,1,"ng-container",2),e.ALo(3,"async")),2&i&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,c.formModel$)))},dependencies:[_.O5,G.u,Z.V,_.Ov],styles:["[_nghost-%COMP%]{width:100%}"]})}return n})();function ot(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-incident-form",4),e.NdJ("formSubmitted",function(c){e.CHM(t);const m=e.oxw(2);return e.KtG(m.affectIncident(c))})("returnToList",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.returnToList())})("fieldReset",function(c){e.CHM(t);const m=e.oxw(2);return e.KtG(m.resetBackendError(c))}),e.qZA()}if(2&n){const t=e.oxw().ngIf,i=e.oxw();e.Q6J("incident",i.itemIncident)("formModel",t)("errors",i.error)("roleIncident",i.roleIncident)}}function st(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ot,1,4,"app-incident-form",3),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.itemIncident)}}let ct=(()=>{class n{constructor(t,i,c,m,T){this.store=t,this.route=i,this.router=c,this.storeAuth=m,this.authService=T,this.formModel$=this.store.select(K),this.incident$=this.store.select(z),this.itemIncident=null,this.errors$=this.store.select(q),this.error={},this.operationType=j.C.BEING_RESOLVED,this.roleIncident=W.s.SUPERVISOR,this.subscription=new V.w0}ngOnInit(){this.store.dispatch(o.resetFormModel()),this.subscription=this.route.params.subscribe(t=>{this.id=t.id,this.id&&this.store.dispatch(o.loadItem({id:this.id}))}),this.store.dispatch(o.resetItem()),this.store.dispatch(o.loadFormModel()),this.errors$.subscribe(t=>{null!==t&&(this.error=t)}),this.incident$.subscribe(t=>{t&&(console.log(t.demandeur),this.itemIncident={id:t.id,titre:t.titre,description:t.description,categorieIncident:t.categorieIncident,probleme:t.probleme,refSys:t.refSys,etapeIncident:t.statutIncident,firstName:null==t.demandeur?"":t.demandeur.firstName,lastName:null==t.demandeur?"":t.demandeur.lastName,userName:null==t.demandeur?"":t.demandeur.userName,demandeur:t.demandeur,firstNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.firstName,lastNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.lastName,userNameGestionnaire:null==t.gestionnaire?"":t.gestionnaire.userName,firstNameSupport:null==t.gestionnaire?"":t.gestionnaire.firstName,lastNameSupport:null==t.gestionnaire?"":t.gestionnaire.lastName,userNameSupport:null==t.gestionnaire?"":t.gestionnaire.userName,gestionnaire:t.gestionnaire,test:this.valueOfRadio(t.demandeur)?"moi-m\xeame":"autre que moi",impact:t.impact,equipement:t.equipement,groupeEquipement:null==t.equipement?"":t.equipement.modelEquip.categoryEquip.groupEquip.libelle,categorieEquipement:null==t.equipement?"":t.equipement.modelEquip.categoryEquip.libelle,sousCategorieEquipement:"",libelleEquipement:null==t.equipement?"":t.equipement.libelle,numeroSerie:null==t.equipement?"":t.equipement.numeroSerie,source:t.source,severite:t.severite,statutIncident:t.statutIncident,prioriteIncident:t.prioriteIncident,typeIncident:t.typeIncident,dateDerniereModification:null===t.dateDerniereModification?"":this.formatDate(t.dateDerniereModification),dateCreation:null===t.dateCreation?"":this.formatDate(t.dateCreation)})})}valueOfRadio(t){return null!==this.authService.getUserInfo()&&null!==t&&this.authService.getUserInfo().firstName===t.firstName&&this.authService.getUserInfo().lastName===t.lastName&&this.authService.getUserInfo().userName===t.userName}formatDate(t){if(t){const i=new Date(t);return i.toLocaleDateString()+" \xe0 "+i.toLocaleTimeString()}return null}ngOnDestroy(){this.subscription.unsubscribe()}affectIncident(t){const i={id:t.id,titre:t.titre,description:t.description,equipement:t.equipement,typeIncident:t.typeIncident,probleme:t.probleme,categorieIncident:t.categorieIncident,gestionnaire:t.gestionnaire,impact:t.impact,prioriteIncident:t.prioriteIncident,source:t.source,severite:t.severite};this.store.dispatch(o.affectItem({id:Number(this.id),item:i}))}resetBackendError(t){console.log(t),this.store.dispatch(o.resetErrorField({fieldName:t}))}returnToList(){this.router.navigateByUrl("incidents/incident")}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.yh),e.Y36(x.gz),e.Y36(x.F0),e.Y36(r.yh),e.Y36(H.e))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-nouvel-incident-affect"]],decls:4,vars:3,consts:[[1,"pt-3","ps-3","pe-3","pb-0","mb-0"],["pathLevelOne","Supervision Incident","pathLevelTwo","Nouvel Incident","pathLevelThree","Affecter"],[4,"ngIf"],[3,"incident","formModel","errors","roleIncident","formSubmitted","returnToList","fieldReset",4,"ngIf"],[3,"incident","formModel","errors","roleIncident","formSubmitted","returnToList","fieldReset"]],template:function(i,c){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"app-custom-breadcrumb",1),e.qZA(),e.YNc(2,st,2,1,"ng-container",2),e.ALo(3,"async")),2&i&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,c.formModel$)))},dependencies:[_.O5,G.u,Z.V,_.Ov],styles:["[_nghost-%COMP%]{width:100%}"]})}return n})(),at=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-nouvel-incident-reject"]],decls:2,vars:0,template:function(i,c){1&i&&(e.TgZ(0,"p"),e._uU(1,"nouvel-incident-reject works!"),e.qZA())}})}return n})();var dt=s(8510),l=s(6465),lt=s(9207),pt=s(1793),mt=s(3396),ut=s(2030),ht=s(2460),C=s(6328),ft=s(9026),b=s(6306),L=s(9397),_t=s(1631),f=s(6063),gt=s(9862),g=s(2096),It=s(3186),Ct=s(4664),St=s(9989),xt=s(1946);let X=(()=>{class n extends St.v{getResourceBasePath(){return`${xt.y}/incident`}getIdValue(t){return t.id}affect(t,i){return this.http.post(`${this.url}/${this.getResourceBasePath()}/affecter/${t}`,i)}reject(t,i){return this.http.post(`${this.url}/${this.getResourceBasePath()}/rejeter/${t}`,i)}static#e=this.\u0275fac=function(){let t;return function(c){return(t||(t=e.n5z(n)))(c||n)}}();static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac})}return n})(),Nt=(()=>{class n{constructor(t,i,c,m,T,R){this.nouvelIncidentService=t,this.authService=i,this.actions$=c,this.router=m,this.modalService=T,this.store=R,this.loadItems$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.loadItems),(0,ht.M)(this.store.select(J),this.store.select(Q),this.store.select(ve)),(0,C.b)(([d,p,$,Y])=>(console.log(p),this.store.dispatch((0,f.Q)()),(0,ft.$)(this.nouvelIncidentService.getAllWithPagination(p,$,Y),this.nouvelIncidentService.count(Y)).pipe((0,I.U)(([E,Et])=>(this.store.dispatch((0,f.Z)()),o.loadItemsSuccess({items:E,totalElement:Et}))),(0,b.K)(E=>(this.store.dispatch((0,f.Z)()),(0,g.of)(o.setError({errors:E})))))))),{dispatch:!0}),this.createItem$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.createItem),(0,C.b)(d=>(this.store.dispatch((0,f.Q)()),console.log(d.item),this.nouvelIncidentService.add(d.item).pipe((0,L.b)(()=>{this.store.dispatch((0,f.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident ajout\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/incident")}),(0,I.U)(p=>o.createItemSuccess({item:p})),(0,b.K)(p=>(this.store.dispatch((0,f.Z)()),(0,g.of)(o.setError({errors:p})))))))),{dispatch:!0}),this.loadItem$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.loadItem),(0,_t.z)(d=>this.nouvelIncidentService.findById(d.id).pipe((0,I.U)(p=>o.loadItemSuccess({item:p})),(0,b.K)(p=>(this.store.dispatch((0,f.Z)()),(0,g.of)(o.setError({errors:p}))))))),{dispatch:!0}),this.deleteItem$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.deleteItem),(0,C.b)(d=>this.nouvelIncidentService.delete(d.item.id,d.item)),(0,L.b)(()=>{this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident supprim\xe9 avec succ\xe8s"})}),(0,I.U)(()=>o.loadItems()),(0,b.K)(d=>(this.store.dispatch((0,f.Z)()),(0,g.of)(o.setError({errors:d}))))),{dispatch:!0}),this.updateItem$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.updateItem),(0,C.b)(d=>(this.store.dispatch((0,f.Q)()),this.nouvelIncidentService.update(d.id,d.item).pipe((0,L.b)(()=>{this.store.dispatch((0,f.Z)()),this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident modifi\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/incident")}),(0,I.U)(p=>o.createItemSuccess({item:p})),(0,b.K)(p=>(this.store.dispatch((0,f.Z)()),(0,g.of)(o.setError({errors:p})))))))),{dispatch:!0}),this.affectItem$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.affectItem),(0,C.b)(d=>(this.store.dispatch((0,f.Q)()),this.nouvelIncidentService.affect(d.id,d.item).pipe((0,L.b)(()=>{this.modalService.openAlert({type:"success",title:"Op\xe9ration r\xe9ussie",message:"Incident Affect\xe9 avec succ\xe8s"}),this.router.navigateByUrl("incidents/incident")}),(0,I.U)(p=>o.affectItemSuccess({item:p})),(0,b.K)(p=>(this.store.dispatch((0,f.Z)()),(0,g.of)(o.setError({errors:p})))))))),{dispatch:!0}),this.loadFormModel$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.loadFormModel),(0,C.b)(()=>this.nouvelIncidentService.getFormModel()),(0,I.U)(d=>o.loadFormModelSuccess({formModel:d})),(0,b.K)(d=>(0,g.of)(o.setError({errors:d}))))),this.resetSearch$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.resetSearch),(0,C.b)(()=>(0,g.of)(o.changePage({page:1}))))),this.search$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.search),(0,C.b)(()=>(0,g.of)(o.changePage({page:1}))))),this.changePage$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.changePage),(0,I.U)(d=>o.loadItems()))),this.changePageSize$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.changePageSize),(0,C.b)(()=>(0,g.of)(o.changePage({page:1}))))),this.handleError$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(o.setError),(0,Ct.w)(d=>{if(this.store.dispatch((0,f.Q)()),d.errors instanceof gt.UA){if(422===d.errors.status){let p="",$=0;for(const[Y,E]of Object.entries(d.errors.error))p+=0===$?E:"\n"+E,$++;this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:p})}if(403===d.errors.status&&this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:"Vous n'avez pas le droit requis pour effectuer cette action"}),401===d.errors.status){let p="Votre token a expir\xe9, veuillez vous reconnecter svp!";return this.authService.removeToken(),this.authService.removeUserInfo(),this.store.dispatch((0,f.Z)()),this.modalService.openAlert({type:"error",title:"Op\xe9ration Erron\xe9e",message:p}),(0,g.of)(It.jM())}}return this.store.dispatch((0,f.Z)()),(0,g.of)({type:"noop"})})),{dispatch:!0})}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(X),e.LFG(H.e),e.LFG(l.eX),e.LFG(x.F0),e.LFG(k.Z),e.LFG(r.yh))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac})}return n})();var vt=s(2018);const bt=[{path:"",component:Xe,pathMatch:"prefix"},{path:"add",component:tt,pathMatch:"prefix"},{path:"edit/:id",component:rt,pathMatch:"prefix"},{path:"affect/:id",component:ct,pathMatch:"prefix"},{path:"reject/:id",component:at,pathMatch:"prefix"}];let Tt=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({providers:[X,vt.k],imports:[_.ez,w.L,r.Aw.forFeature("nouvel-incidents",xe),l.sQ.forFeature(Nt),dt.Y,ut.h,mt.B,pt.K,lt.m,x.Bz.forChild(bt)]})}return n})()},4849:(ee,M,s)=>{s.d(M,{n:()=>I});var _=s(1892),D=s(6814),O=s(8666),B=s(2463),h=s(9468),F=s(166);let I=(()=>{class r{constructor(y,N){this.modalData=y,this.modalRef=N}close(){this.modalRef.close(void 0)}confirmAction(){this.modalRef.close("yes")}static#e=this.\u0275fac=function(N){return new(N||r)(h.Y36(_.S),h.Y36(_.R))};static#t=this.\u0275cmp=h.Xpm({type:r,selectors:[["app-confirm-alert"]],standalone:!0,features:[h.jDz],decls:13,vars:0,consts:[[1,"alert-header","mb-3"],[1,"alert-header-title"],[1,"mb-0"],[1,"pe-3","ps-3","pt-0"],[1,"d-flex","align-items-center","p-2"],[1,"me-3"],["src","assets/images/warning.svg","width","45px","alt",""],[1,"text"],[1,"form-actions"],["otherclass","custom-cancel-button color-warning","title","Oui",1,"me-1",3,"buttonClicked"],["otherclass","custom-cancel-button","title","Fermer",3,"buttonClicked"]],template:function(N,P){1&N&&(h.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),h._uU(3,"Confirmation de Suppression"),h.qZA()()(),h.TgZ(4,"div",3)(5,"div",4)(6,"div",5),h._UZ(7,"img",6),h.qZA(),h.TgZ(8,"div",7),h._uU(9," Voulez-vous vraiment effectuer cette action ? "),h.qZA()(),h.TgZ(10,"div",8)(11,"app-custom-button",9),h.NdJ("buttonClicked",function(){return P.confirmAction()}),h.qZA(),h.TgZ(12,"app-custom-button",10),h.NdJ("buttonClicked",function(){return P.close()}),h.qZA()()())},dependencies:[D.ez,O.a,B.v,F.x],styles:[".general-info[_ngcontent-%COMP%]{display:flex;padding:5px 0;width:100%}.form-main[_ngcontent-%COMP%]{background-color:#e7e8ea;border:1px solid #c7c5c6}.input-container[_ngcontent-%COMP%]{display:flex;align-items:center}.input-textfield-container[_ngcontent-%COMP%]{margin-left:4px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:.5rem}.form-actions[_ngcontent-%COMP%]   app-primary-button[_ngcontent-%COMP%]{margin-left:.5rem}.alert-header[_ngcontent-%COMP%]{background-color:#ed6f25;color:#fff;padding:.5rem 1rem;display:flex;align-items:center}.alert-header-title[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1}.close-icon[_ngcontent-%COMP%]{cursor:pointer}.alert-header-title[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1rem}input[type=file][_ngcontent-%COMP%]{font-size:13px}.circle-content-error[_ngcontent-%COMP%]{border-radius:50%;border:1px solid #ed6f25;color:#ed6f25;width:70px;height:70px;display:flex;align-items:center;justify-content:center}.circle-content-error[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:25px}.text[_ngcontent-%COMP%]{font-size:14px!important}"]})}return r})()}}]);